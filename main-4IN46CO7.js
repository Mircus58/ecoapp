import{b as gh,c as _h,d as yh,e as vh,j as Ih}from"./chunk-2WZPH4LJ.js";import"./chunk-SEDQEPVQ.js";import{$a as pr,A as Ii,Ca as uh,E as gn,Ja as lh,L as ih,La as Ao,Ma as hh,N as zt,Na as dh,Oa as bo,Q as Wt,R as sh,S as Gt,V as $e,X as To,Xa as fh,Y as re,Ya as ph,Z as pe,_ as je,_a as mh,aa as oh,ba as Ei,c as ke,ca as ah,f as vi,ga as Ne,h as nh,i as rh,ja as wi,k as vo,la as Se,m as Io,n as Eo,p as wo,sa as ch,t as be,z as mn}from"./chunk-3PCK376T.js";import"./chunk-YHXYT522.js";import"./chunk-LSGGBWND.js";import"./chunk-VNYDC4M7.js";import"./chunk-5AUDRUWC.js";import"./chunk-5FZ7CLL4.js";import"./chunk-4WFVMWDK.js";import"./chunk-NE76QGZZ.js";import"./chunk-NMYJD6OP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-7D2EH4XU.js";import"./chunk-MMIXVVWR.js";import"./chunk-SV7S5NYR.js";import{a as fr,b as yo,e as St,f as y}from"./chunk-D7YYRZS5.js";var Ti=class n{title="ecoapp";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=uh({type:n,selectors:[["app-root"]],decls:3,vars:0,consts:[["manifest-url","./manifest.webmanifest"]],template:function(t,r){t&1&&(bo(0,"pwa-install",0),hh(1,"ion-app"),bo(2,"ion-router-outlet"),dh())},dependencies:[yh,vh],encapsulation:2})};var Eh=()=>{};var Ah=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},gg=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Ai={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,v=(o&3)<<4|u>>4,w=(u&15)<<2|d>>6,R=d&63;h||(R=64,a||(w=64)),r.push(t[p],t[v],t[w],t[R])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Ah(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):gg(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let v=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||v==null)throw new Po;let w=o<<2|u>>4;if(r.push(w),d!==64){let R=u<<4&240|d>>2;if(r.push(R),v!==64){let D=d<<6&192|v;r.push(D)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Po=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},_g=function(n){let e=Ah(n);return Ai.encodeByteArray(e,!0)},gr=function(n){return _g(n).replace(/\./g,"")},bi=function(n){try{return Ai.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ko(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var yg=()=>ko().__FIREBASE_DEFAULTS__,vg=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Ig=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&bi(n[1]);return e&&JSON.parse(e)},Si=()=>{try{return Eh()||yg()||vg()||Ig()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Do=n=>{var e,t;return(t=(e=Si())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Ri=n=>{let e=Do(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},No=()=>{var n;return(n=Si())===null||n===void 0?void 0:n.config},Oo=n=>{var e;return(e=Si())===null||e===void 0?void 0:e[`_${n}`]};var Ht=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function st(n){return n.endsWith(".cloudworkstations.dev")}function _n(n){return y(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function Pi(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[gr(JSON.stringify(t)),gr(JSON.stringify(a)),""].join(".")}var mr={};function Eg(){let n={prod:[],emulator:[]};for(let e of Object.keys(mr))mr[e]?n.emulator.push(e):n.prod.push(e);return n}function wg(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var wh=!1;function ot(n,e){if(typeof window>"u"||typeof document>"u"||!st(window.location.host)||mr[n]===e||mr[n]||wh)return;mr[n]=e;function t(w){return`__firebase__banner__${w}`}let r="__firebase__banner",o=Eg().prod.length>0;function a(){let w=document.getElementById(r);w&&w.remove()}function u(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function h(w,R){w.setAttribute("width","24"),w.setAttribute("id",R),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function d(){let w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{wh=!0,a()},w}function p(w,R){w.setAttribute("id",R),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function v(){let w=wg(r),R=t("text"),D=document.getElementById(R)||document.createElement("span"),x=t("learnmore"),C=document.getElementById(x)||document.createElement("a"),j=t("preprendIcon"),q=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){let U=w.element;u(U),p(C,x);let $=d();h(q,j),U.append(q,D,C,$),document.body.appendChild(U)}o?(D.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,D.innerText="Preview backend running in this workspace."),D.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function le(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(le())}function Tg(){var n;let e=(n=Si())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Sh(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Rh(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Ph(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ch(){let n=le();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function kh(){return!Tg()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _r(){try{return typeof indexedDB=="object"}catch{return!1}}function Dh(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var Ag="FirebaseError",Ae=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Ag,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Me.prototype.create)}},Me=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?bg(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Ae(i,u,r)}};function bg(n,e){return n.replace(Sg,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Sg=/\{\$([^}]+)}/g;function Nh(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ze(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(Th(o)&&Th(a)){if(!ze(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Th(n){return n!==null&&typeof n=="object"}function yr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Oh(n,e){let t=new Co(n,e);return t.subscribe.bind(t)}var Co=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Rg(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ro),i.error===void 0&&(i.error=Ro),i.complete===void 0&&(i.complete=Ro);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Rg(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ro(){}var ET=4*60*60*1e3;function Re(n){return n&&n._delegate?n._delegate:n}var me=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Kt="[DEFAULT]";var xo=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Ht;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Cg(e))try{this.getOrInitializeService({instanceIdentifier:Kt})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Kt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Kt){return this.instances.has(e)}getOptions(e=Kt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Pg(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kt){return this.component?this.component.multipleInstances?e:Kt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Pg(n){return n===Kt?void 0:n}function Cg(n){return n.instantiationMode==="EAGER"}var Ci=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new xo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var kg=[],W=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(W||{}),Dg={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},Ng=W.INFO,Og={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},xg=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Og[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},We=class{constructor(e){this.name=e,this._logLevel=Ng,this._logHandler=xg,this._userLogHandler=null,kg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in W))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Dg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}};var Vg=(n,e)=>e.some(t=>n instanceof t),xh,Vh;function Lg(){return xh||(xh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mg(){return Vh||(Vh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Lh=new WeakMap,Lo=new WeakMap,Mh=new WeakMap,Vo=new WeakMap,Fo=new WeakMap;function Fg(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(Ge(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Lh.set(t,n)}).catch(()=>{}),Fo.set(e,n),e}function Ug(n){if(Lo.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Lo.set(n,e)}var Mo={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Lo.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Mh.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ge(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Fh(n){Mo=n(Mo)}function Bg(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ki(this),e,...t);return Mh.set(r,e.sort?e.sort():[e]),Ge(r)}:Mg().includes(n)?function(...e){return n.apply(ki(this),e),Ge(Lh.get(this))}:function(...e){return Ge(n.apply(ki(this),e))}}function qg(n){return typeof n=="function"?Bg(n):(n instanceof IDBTransaction&&Ug(n),Vg(n,Lg())?new Proxy(n,Mo):n)}function Ge(n){if(n instanceof IDBRequest)return Fg(n);if(Vo.has(n))return Vo.get(n);let e=qg(n);return e!==n&&(Vo.set(n,e),Fo.set(e,n)),e}var ki=n=>Fo.get(n);function Bh(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=Ge(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Ge(a.result),h.oldVersion,h.newVersion,Ge(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var $g=["get","getKey","getAll","getAllKeys","count"],jg=["put","add","delete","clear"],Uo=new Map;function Uh(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Uo.get(e))return Uo.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=jg.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||$g.includes(t)))return;let o=function(a,...u){return y(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return Uo.set(e,o),o}Fh(n=>yo(fr({},n),{get:(e,t,r)=>Uh(e,t)||n.get(e,t,r),has:(e,t)=>!!Uh(e,t)||n.has(e,t)}));var qo=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(zg(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function zg(n){let e=n.getComponent();return e?.type==="VERSION"}var $o="@firebase/app",qh="0.12.3";var at=new We("@firebase/app"),Wg="@firebase/app-compat",Gg="@firebase/analytics-compat",Hg="@firebase/analytics",Kg="@firebase/app-check-compat",Qg="@firebase/app-check",Yg="@firebase/auth",Jg="@firebase/auth-compat",Xg="@firebase/database",Zg="@firebase/data-connect",e_="@firebase/database-compat",t_="@firebase/functions",n_="@firebase/functions-compat",r_="@firebase/installations",i_="@firebase/installations-compat",s_="@firebase/messaging",o_="@firebase/messaging-compat",a_="@firebase/performance",c_="@firebase/performance-compat",u_="@firebase/remote-config",l_="@firebase/remote-config-compat",h_="@firebase/storage",d_="@firebase/storage-compat",f_="@firebase/firestore",p_="@firebase/vertexai",m_="@firebase/firestore-compat",g_="firebase",__="11.7.3";var jo="[DEFAULT]",y_={[$o]:"fire-core",[Wg]:"fire-core-compat",[Hg]:"fire-analytics",[Gg]:"fire-analytics-compat",[Qg]:"fire-app-check",[Kg]:"fire-app-check-compat",[Yg]:"fire-auth",[Jg]:"fire-auth-compat",[Xg]:"fire-rtdb",[Zg]:"fire-data-connect",[e_]:"fire-rtdb-compat",[t_]:"fire-fn",[n_]:"fire-fn-compat",[r_]:"fire-iid",[i_]:"fire-iid-compat",[s_]:"fire-fcm",[o_]:"fire-fcm-compat",[a_]:"fire-perf",[c_]:"fire-perf-compat",[u_]:"fire-rc",[l_]:"fire-rc-compat",[h_]:"fire-gcs",[d_]:"fire-gcs-compat",[f_]:"fire-fst",[m_]:"fire-fst-compat",[p_]:"fire-vertex","fire-js":"fire-js",[g_]:"fire-js-all"};var vr=new Map,v_=new Map,zo=new Map;function $h(n,e){try{n.container.addComponent(e)}catch(t){at.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function De(n){let e=n.name;if(zo.has(e))return at.debug(`There were multiple attempts to register component ${e}.`),!1;zo.set(e,n);for(let t of vr.values())$h(t,n);for(let t of v_.values())$h(t,n);return!0}function Pt(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Pe(n){return n==null?!1:n.settings!==void 0}var I_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rt=new Me("app","Firebase",I_);var Wo=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new me("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rt.create("app-deleted",{appName:this._name})}};var He=__;function Ko(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:jo,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Rt.create("bad-app-name",{appName:String(i)});if(t||(t=No()),!t)throw Rt.create("no-options");let o=vr.get(i);if(o){if(ze(t,o.options)&&ze(r,o.config))return o;throw Rt.create("duplicate-app",{appName:i})}let a=new Ci(i);for(let h of zo.values())a.addComponent(h);let u=new Wo(t,r,a);return vr.set(i,u),u}function ct(n=jo){let e=vr.get(n);if(!e&&n===jo&&No())return Ko();if(!e)throw Rt.create("no-app",{appName:n});return e}function Di(){return Array.from(vr.values())}function X(n,e,t){var r;let i=(r=y_[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),at.warn(u.join(" "));return}De(new me(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var E_="firebase-heartbeat-database",w_=1,Ir="firebase-heartbeat-store",Bo=null;function Gh(){return Bo||(Bo=Bh(E_,w_,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ir)}catch(t){console.warn(t)}}}}).catch(n=>{throw Rt.create("idb-open",{originalErrorMessage:n.message})})),Bo}function T_(n){return y(this,null,function*(){try{let t=(yield Gh()).transaction(Ir),r=yield t.objectStore(Ir).get(Hh(n));return yield t.done,r}catch(e){if(e instanceof Ae)at.warn(e.message);else{let t=Rt.create("idb-get",{originalErrorMessage:e?.message});at.warn(t.message)}}})}function jh(n,e){return y(this,null,function*(){try{let r=(yield Gh()).transaction(Ir,"readwrite");yield r.objectStore(Ir).put(e,Hh(n)),yield r.done}catch(t){if(t instanceof Ae)at.warn(t.message);else{let r=Rt.create("idb-set",{originalErrorMessage:t?.message});at.warn(r.message)}}})}function Hh(n){return`${n.name}!${n.options.appId}`}var A_=1024,b_=30,Go=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Ho(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=zh();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>b_){let a=R_(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){at.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=zh(),{heartbeatsToSend:r,unsentEntries:i}=S_(this._heartbeatsCache.heartbeats),o=gr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return at.warn(t),""}})}};function zh(){return new Date().toISOString().substring(0,10)}function S_(n,e=A_){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),Wh(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Wh(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Ho=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return _r()?Dh().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield T_(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return jh(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return jh(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Wh(n){return gr(JSON.stringify({version:2,heartbeats:n})).length}function R_(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function P_(n){De(new me("platform-logger",e=>new qo(e),"PRIVATE")),De(new me("heartbeat",e=>new Go(e),"PRIVATE")),X($o,qh,n),X($o,qh,"esm2017"),X("fire-js","")}P_("");var C_="firebase",k_="11.7.3";X(C_,k_,"app");function Qo(n){n===void 0&&(ah(Qo),n=re(Ne));let e=n.get(wi);return t=>new ke(r=>{let i=e.add(),o=!1;function a(){o||(i(),o=!0)}let u=t.subscribe({next:h=>{r.next(h),a()},complete:()=>{r.complete(),a()},error:h=>{r.error(h),a()}});return u.add(()=>{r.unsubscribe(),a()}),u})}var Ke=new fh("ANGULARFIRE2_VERSION");function Yt(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Ct=(n,e)=>{let t=e?[e]:Di(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},yn=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(yn||{}),Kh=pr()&&typeof Zone<"u"?yn.WARN:yn.SILENT;var Ni=class{zone;delegate;constructor(e,t=rh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i?i.runGuarded(()=>{e.apply(this,[a])}):e.apply(this,[a])};return this.delegate.schedule(o,t,r)}},Qe=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=re(Se);this.outsideAngular=t.runOutsideAngular(()=>new Ni(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Ni(typeof Zone>"u"?void 0:Zone.current,nh))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Gt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qh=!1;function D_(n,e){!Qh&&(Kh>yn.SILENT||pr())&&(Qh=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),Kh>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function N_(n){let e=re(Se,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function Qt(n){let e=re(Se,{optional:!0});return e?e.run(()=>n()):n()}var O_=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Ei(t,()=>Qt(()=>n.apply(void 0,r)))),Oe=(n,e,t)=>(t||=e?yn.WARN:yn.VERBOSE,function(){let r,i=arguments,o,a,u;try{o=re(Qe),a=re(wi),u=re(oh)}catch{return D_(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=Qt(()=>a.add())),i[d]=O_(i[d],r,u));let h=N_(()=>n.apply(this,i));return e?h instanceof ke?h.pipe(Eo(o.outsideAngular),Io(o.insideAngular),Qo(u)):h instanceof Promise?Qt(()=>new Promise((d,p)=>{a.run(()=>h).then(v=>Ei(u,()=>Qt(()=>d(v))),v=>Ei(u,()=>Qt(()=>p(v))))})):typeof h=="function"&&r?function(){return setTimeout(r,0),h.apply(this,arguments)}:Qt(()=>h):h instanceof ke?h.pipe(Eo(o.outsideAngular),Io(o.insideAngular)):Qt(()=>h)});var Fe=class{constructor(e){return e}},ut=class{constructor(){return Di()}};function x_(n){return n&&n.length===1?n[0]:new Fe(ct())}var Yo=new $e("angularfire2._apps"),V_={provide:Fe,useFactory:x_,deps:[[new pe,Yo]]},L_={provide:ut,deps:[[new pe,Yo]]};function M_(n){return(e,t)=>{let r=t.get(ch);X("angularfire",Ke.full,"core"),X("angularfire",Ke.full,"app"),X("angular",ph.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Fe(i)}}function Yh(n,...e){return je([V_,L_,{provide:Yo,useFactory:M_(n),multi:!0,deps:[Se,Ne,Qe,...e]}])}var Jh=Oe(Ko,!0);var F_=new Map,U_={activated:!1,tokenObservers:[]},B_={initialized:!1,enabled:!1};function Ue(n){return F_.get(n)||Object.assign({},U_)}function td(){return B_}var q_="https://content-firebaseappcheck.googleapis.com/v1";var $_="exchangeDebugToken",Xh={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},DA=24*60*60*1e3;var Zo=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return y(this,null,function*(){this.stop();try{this.pending=new Ht,this.pending.promise.catch(t=>{}),yield j_(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Ht,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function j_(n){return new Promise(e=>{setTimeout(e,n)})}var z_={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},kt=new Me("appCheck","AppCheck",z_);function nd(n){if(!Ue(n).activated)throw kt.create("use-before-activation",{appName:n.name})}function rd(r,i){return y(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){let R=yield a.getHeartbeatsHeader();R&&(o["X-Firebase-Client"]=R)}let u={method:"POST",body:JSON.stringify(e),headers:o},h;try{h=yield fetch(n,u)}catch(R){throw kt.create("fetch-network-error",{originalErrorMessage:R?.message})}if(h.status!==200)throw kt.create("fetch-status-error",{httpStatus:h.status});let d;try{d=yield h.json()}catch(R){throw kt.create("fetch-parse-error",{originalErrorMessage:R?.message})}let p=d.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw kt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let v=Number(p[1])*1e3,w=Date.now();return{token:d.token,expireTimeMillis:w+v,issuedAtTimeMillis:w}})}function id(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${q_}/projects/${t}/apps/${r}:${$_}?key=${i}`,body:{debug_token:e}}}var W_="firebase-app-check-database",G_=1,ea="firebase-app-check-store";var Oi=null;function H_(){return Oi||(Oi=new Promise((n,e)=>{try{let t=indexedDB.open(W_,G_);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(kt.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(ea,{keyPath:"compositeKey"})}}}catch(t){e(kt.create("storage-open",{originalErrorMessage:t?.message}))}}),Oi)}function K_(n,e){return Q_(Y_(n),e)}function Q_(n,e){return y(this,null,function*(){let r=(yield H_()).transaction(ea,"readwrite"),o=r.objectStore(ea).put({compositeKey:n,value:e});return new Promise((a,u)=>{o.onsuccess=h=>{a()},r.onerror=h=>{var d;u(kt.create("storage-set",{originalErrorMessage:(d=h.target.error)===null||d===void 0?void 0:d.message}))}})})}function Y_(n){return`${n.options.appId}-${n.name}`}var Er=new We("@firebase/app-check");function Jo(n,e){return _r()?K_(n,e).catch(t=>{Er.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function sd(){return td().enabled}function od(){return y(this,null,function*(){let n=td();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var J_={error:"UNKNOWN_ERROR"};function X_(n){return Ai.encodeString(JSON.stringify(n),!1)}function ta(n,e=!1,t=!1){return y(this,null,function*(){let r=n.app;nd(r);let i=Ue(r),o=i.token,a;if(o&&!wr(o)&&(i.token=void 0,o=void 0),!o){let d=yield i.cachedTokenPromise;d&&(wr(d)?o=d:yield Jo(r,void 0))}if(!e&&o&&wr(o))return{token:o.token};let u=!1;if(sd())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=rd(id(r,yield od()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);let d=yield i.exchangeTokenPromise;return yield Jo(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Er.warn(d.message):t&&Er.error(d),Xo(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),o=yield Ue(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Er.warn(d.message):t&&Er.error(d),a=d}let h;return o?a?wr(o)?h={token:o.token,internalError:a}:h=Xo(a):(h={token:o.token},i.token=o,yield Jo(r,o)):h=Xo(a),u&&ny(r,h),h})}function Z_(n){return y(this,null,function*(){let e=n.app;nd(e);let{provider:t}=Ue(e);if(sd()){let r=yield od(),{token:i}=yield rd(id(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function ey(n,e,t,r){let{app:i}=n,o=Ue(i),a={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,a],o.token&&wr(o.token)){let u=o.token;Promise.resolve().then(()=>{t({token:u.token}),Zh(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>Zh(n))}function ad(n,e){let t=Ue(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function Zh(n){let{app:e}=n,t=Ue(e),r=t.tokenRefresher;r||(r=ty(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function ty(n){let{app:e}=n;return new Zo(()=>y(null,null,function*(){let t=Ue(e),r;if(t.token?r=yield ta(n,!0):r=yield ta(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Ue(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Xh.RETRIAL_MIN_WAIT,Xh.RETRIAL_MAX_WAIT)}function ny(n,e){let t=Ue(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function wr(n){return n.expireTimeMillis-Date.now()>0}function Xo(n){return{token:X_(J_),error:n}}var na=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Ue(this.app);for(let t of e)ad(this.app,t.next);return Promise.resolve()}};function ry(n,e){return new na(n,e)}function iy(n){return{getToken:e=>ta(n,e),getLimitedUseToken:()=>Z_(n),addTokenListener:e=>ey(n,"INTERNAL",e),removeTokenListener:e=>ad(n.app,e)}}var sy="@firebase/app-check",oy="0.9.3";var ay="app-check",ed="app-check-internal";function cy(){De(new me(ay,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return ry(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(ed).initialize()})),De(new me(ed,n=>{let e=n.getProvider("app-check").getImmediate();return iy(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),X(sy,oy)}cy();var uy="app-check";var Dt=class{constructor(){return Ct(uy)}};var ly=["localhost","0.0.0.0","127.0.0.1"],zA=typeof window<"u"&&ly.includes(window.location.hostname);function wd(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Td=wd,Ad=new Me("auth","Firebase",wd());var Ui=new We("@firebase/auth");function hy(n,...e){Ui.logLevel<=W.WARN&&Ui.warn(`Auth (${He}): ${n}`,...e)}function Vi(n,...e){Ui.logLevel<=W.ERROR&&Ui.error(`Auth (${He}): ${n}`,...e)}function xt(n,...e){throw wa(n,...e)}function Xt(n,...e){return wa(n,...e)}function bd(n,e,t){let r=Object.assign(Object.assign({},Td()),{[e]:t});return new Me("auth","Firebase",r).create(e,{appName:n.name})}function Jt(n){return bd(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wa(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Ad.create(n,...e)}function M(n,e,...t){if(!n)throw wa(e,...t)}function lt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Vi(e),new Error(e)}function Vt(n,e){n||lt(e)}function oa(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function dy(){return cd()==="http:"||cd()==="https:"}function cd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function fy(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(dy()||Rh()||"connection"in navigator)?navigator.onLine:!0}function py(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Zt=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vt(t>e,"Short delay should be less than long delay!"),this.isMobile=bh()||Ph()}get(){return fy()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Ta(n,e){Vt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Bi=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;lt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;lt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;lt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var my={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var gy=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],_y=new Zt(3e4,6e4);function Aa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function vn(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){return Sd(n,i,()=>y(null,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let v=yr(Object.assign({key:n.config.apiKey},p)).slice(1),w=yield n._getAdditionalHeaders();w["Content-Type"]="application/json",n.languageCode&&(w["X-Firebase-Locale"]=n.languageCode);let R=Object.assign({method:e,headers:w},d);return Sh()||(R.referrerPolicy="no-referrer"),n.emulatorConfig&&st(n.emulatorConfig.host)&&(R.credentials="include"),Bi.fetch()(yield Rd(n,n.config.apiHost,t,v),R)}))})}function Sd(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},my),e);try{let i=new aa(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw xi(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw xi(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw xi(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw xi(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw bd(n,p,d);xt(n,p)}}catch(i){if(i instanceof Ae)throw i;xt(n,"network-request-failed",{message:String(i)})}})}function yy(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield vn(n,e,t,r,i);return"mfaPendingCredential"in d&&xt(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function Rd(n,e,t,r){return y(this,null,function*(){let i=`${e}${t}?${r}`,o=n,a=o.config.emulator?Ta(n.config,i):`${n.config.apiScheme}://${i}`;return gy.includes(t)&&(yield o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a})}var aa=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Xt(this.auth,"network-request-failed")),_y.get())})}};function xi(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Xt(n,e,r);return i.customData._tokenResponse=t,i}function vy(n,e){return y(this,null,function*(){return vn(n,"POST","/v1/accounts:delete",e)})}function qi(n,e){return y(this,null,function*(){return vn(n,"POST","/v1/accounts:lookup",e)})}function Tr(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function ba(n,e=!1){return y(this,null,function*(){let t=Re(n),r=yield t.getIdToken(e),i=Sa(r);M(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:Tr(ra(i.auth_time)),issuedAtTime:Tr(ra(i.iat)),expirationTime:Tr(ra(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function ra(n){return Number(n)*1e3}function Sa(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Vi("JWT malformed, contained fewer than 3 sections"),null;try{let i=bi(t);return i?JSON.parse(i):(Vi("Failed to decode base64 JWT payload"),null)}catch(i){return Vi("Caught error parsing JWT payload as JSON",i?.toString()),null}}function ud(n){let e=Sa(n);return M(e,"internal-error"),M(typeof e.exp<"u","internal-error"),M(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function br(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Ae&&Iy(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function Iy({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ca=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Sr=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Tr(this.lastLoginAt),this.creationTime=Tr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function $i(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield br(n,qi(t,{idToken:r}));M(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Pd(o.providerUserInfo):[],u=Ey(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,p=h?d:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Sr(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,v)})}function Ra(n){return y(this,null,function*(){let e=Re(n);yield $i(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Ey(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Pd(n){return n.map(e=>{var{providerId:t}=e,r=vo(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function wy(n,e){return y(this,null,function*(){let t=yield Sd(n,{},()=>y(null,null,function*(){let r=yr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=yield Rd(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Bi.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function Ty(n,e){return y(this,null,function*(){return vn(n,"POST","/v2/accounts:revokeToken",Aa(n,e))})}var Ar=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){M(e.idToken,"internal-error"),M(typeof e.idToken<"u","internal-error"),M(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ud(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){M(e.length!==0,"internal-error");let t=ud(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(M(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield wy(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(M(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(M(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(M(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return lt("not implemented")}};function Nt(n,e){M(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Ot=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=vo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ca(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Sr(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield br(this,this.stsTokenManager.getToken(this.auth,e));return M(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return ba(this,e)}reload(){return Ra(this)}_assign(e){this!==e&&(M(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield $i(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(Pe(this.auth.app))return Promise.reject(Jt(this.auth));let e=yield this.getIdToken();return yield br(this,vy(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,p;let v=(r=t.displayName)!==null&&r!==void 0?r:void 0,w=(i=t.email)!==null&&i!==void 0?i:void 0,R=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,D=(a=t.photoURL)!==null&&a!==void 0?a:void 0,x=(u=t.tenantId)!==null&&u!==void 0?u:void 0,C=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,j=(d=t.createdAt)!==null&&d!==void 0?d:void 0,q=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:U,emailVerified:$,isAnonymous:se,providerData:K,stsTokenManager:E}=t;M(U&&E,e,"internal-error");let m=Ar.fromJSON(this.name,E);M(typeof U=="string",e,"internal-error"),Nt(v,e.name),Nt(w,e.name),M(typeof $=="boolean",e,"internal-error"),M(typeof se=="boolean",e,"internal-error"),Nt(R,e.name),Nt(D,e.name),Nt(x,e.name),Nt(C,e.name),Nt(j,e.name),Nt(q,e.name);let _=new n({uid:U,auth:e,email:w,emailVerified:$,displayName:v,isAnonymous:se,photoURL:D,phoneNumber:R,tenantId:x,stsTokenManager:m,createdAt:j,lastLoginAt:q});return K&&Array.isArray(K)&&(_.providerData=K.map(I=>Object.assign({},I))),C&&(_._redirectEventId=C),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new Ar;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield $i(o),o})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];M(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Pd(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new Ar;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Sr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var ld=new Map;function ht(n){Vt(n instanceof Function,"Expected a class definition");let e=ld.get(n);return e?(Vt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ld.set(n,e),e)}var Ay=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ua=Ay;function Li(n,e,t){return`firebase:${n}:${e}:${t}`}var ji=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=Li(this.userKey,i.apiKey,o),this.fullPersistenceKey=Li("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield qi(this.auth,{idToken:e}).catch(()=>{});return t?Ot._fromGetAccountInfoResponse(this.auth,t,e):null}return Ot._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(ht(ua),e,r);let i=(yield Promise.all(t.map(d=>y(null,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||ht(ua),a=Li(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let v;if(typeof p=="string"){let w=yield qi(e,{idToken:p}).catch(()=>{});if(!w)break;v=yield Ot._fromGetAccountInfoResponse(e,w,p)}else v=Ot._fromJSON(e,p);d!==o&&(u=v),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(d=>y(null,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function hd(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Nd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Cd(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xd(e))return"Blackberry";if(Vd(e))return"Webos";if(kd(e))return"Safari";if((e.includes("chrome/")||Dd(e))&&!e.includes("edge/"))return"Chrome";if(Od(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Cd(n=le()){return/firefox\//i.test(n)}function kd(n=le()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Dd(n=le()){return/crios\//i.test(n)}function Nd(n=le()){return/iemobile/i.test(n)}function Od(n=le()){return/android/i.test(n)}function xd(n=le()){return/blackberry/i.test(n)}function Vd(n=le()){return/webos/i.test(n)}function Pa(n=le()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function by(n=le()){var e;return Pa(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Sy(){return Ch()&&document.documentMode===10}function Ld(n=le()){return Pa(n)||Od(n)||Vd(n)||xd(n)||/windows phone/i.test(n)||Nd(n)}function Md(n,e=[]){let t;switch(n){case"Browser":t=hd(le());break;case"Worker":t=`${hd(le())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${He}/${r}`}var la=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function Ry(t){return y(this,arguments,function*(n,e={}){return vn(n,"GET","/v2/passwordPolicy",Aa(n,e))})}var Py=6,ha=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:Py,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var da=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zi(this),this.idTokenSubscription=new zi(this),this.beforeStateQueue=new la(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ad,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ht(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i,o;if(!this._deleted&&(this.persistenceManager=yield ji.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield qi(this,{idToken:e}),r=yield Ot._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(Pe(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return M(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield $i(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=py()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(Pe(this.app))return Promise.reject(Jt(this));let t=e?Re(e):null;return t&&M(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&M(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return Pe(this.app)?Promise.reject(Jt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Pe(this.app)?Promise.reject(Jt(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(ht(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield Ry(this),t=new ha(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Me("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield Ty(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&ht(e)||this._popupRedirectResolver;M(t,this,"argument-error"),this.redirectPersistenceManager=yield ji.create(this,[ht(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(M(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Md(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;if(Pe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&hy(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Ca(n){return Re(n)}var zi=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Oh(t=>this.observer=t)}get next(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var ka={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Cy(n){ka=n}function ky(n){return ka.loadJS(n)}function Dy(){return ka.gapiScript}function Fd(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Da(n,e){let t=Pt(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(ze(o,e??{}))return i;xt(i,"already-initialized")}return t.initialize({options:e})}function Ny(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(ht);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Na(n,e,t){let r=Ca(n);M(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=Ud(e),{host:a,port:u}=Oy(e),h=u===null?"":`:${u}`,d={url:`${o}//${a}${h}/`},p=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){M(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),M(ze(d,r.config.emulator)&&ze(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,st(a)?(ot("Auth",!0),_n(`${o}//${a}${h}`)):i||xy()}function Ud(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Oy(n){let e=Ud(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:dd(r.substr(o.length+1))}}else{let[o,a]=r.split(":");return{host:o,port:dd(a)}}}function dd(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function xy(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Wi=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return lt("not implemented")}_getIdTokenResponse(e){return lt("not implemented")}_linkToIdToken(e,t){return lt("not implemented")}_getReauthenticationResolver(e){return lt("not implemented")}};function ia(n,e){return y(this,null,function*(){return yy(n,"POST","/v1/accounts:signInWithIdp",Aa(n,e))})}var Gi=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var fa=class extends Gi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Rr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let o=yield Ot._fromIdTokenResponse(e,r,i),a=fd(r);return new n({user:o,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=fd(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function fd(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var pa=class n extends Ae{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Bd(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?pa._fromErrorAndOperation(n,o,e,r):o})}function Vy(n,e,t=!1){return y(this,null,function*(){let r=yield br(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Rr._forOperation(n,"link",r)})}function Ly(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(Pe(r.app))return Promise.reject(Jt(r));let i="reauthenticate";try{let o=yield br(n,Bd(r,i,e,n),t);M(o.idToken,r,"internal-error");let a=Sa(o.idToken);M(a,r,"internal-error");let{sub:u}=a;return M(n.uid===u,r,"user-mismatch"),Rr._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&xt(r,"user-mismatch"),o}})}function My(n,e,t=!1){return y(this,null,function*(){if(Pe(n.app))return Promise.reject(Jt(n));let r="signIn",i=yield Bd(n,r,e),o=yield Rr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function Ji(n,e,t,r){return Re(n).onIdTokenChanged(e,t,r)}function Oa(n,e,t){return Re(n).beforeAuthStateChanged(e,t)}function Xi(n,e,t,r){return Re(n).onAuthStateChanged(e,t,r)}var Hi="__sak";var Ki=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hi,"1"),this.storage.removeItem(Hi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var Fy=1e3,Uy=10,By=(()=>{class n extends Ki{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ld(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);Sy()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,Uy):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},Fy)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield St(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield St(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield St(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),qd=By;var qy=(()=>{class n extends Ki{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),xa=qy;function $y(n){return Promise.all(n.map(e=>y(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var jy=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:o,data:a}=r.data,u=this.handlersMap[o];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let h=Array.from(u).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield $y(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function $d(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var ma=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,h)=>{let d=$d("",20);i.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(v){let w=v;if(w.data.eventId===d)switch(w.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(w.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function Ye(){return window}function zy(n){Ye().location.href=n}function jd(){return typeof Ye().WorkerGlobalScope<"u"&&typeof Ye().importScripts=="function"}function Wy(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function Gy(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Hy(){return jd()?self:null}var zd="firebaseLocalStorageDb",Ky=1,Qi="firebaseLocalStorage",Wd="fbase_key",en=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Zi(n,e){return n.transaction([Qi],e?"readwrite":"readonly").objectStore(Qi)}function Qy(){let n=indexedDB.deleteDatabase(zd);return new en(n).toPromise()}function ga(){let n=indexedDB.open(zd,Ky);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Qi,{keyPath:Wd})}catch(i){t(i)}}),n.addEventListener("success",()=>y(null,null,function*(){let r=n.result;r.objectStoreNames.contains(Qi)?e(r):(r.close(),yield Qy(),e(yield ga()))}))})}function pd(n,e,t){return y(this,null,function*(){let r=Zi(n,!0).put({[Wd]:e,value:t});return new en(r).toPromise()})}function Yy(n,e){return y(this,null,function*(){let t=Zi(n,!1).get(e),r=yield new en(t).toPromise();return r===void 0?null:r.value})}function md(n,e){let t=Zi(n,!0).delete(e);return new en(t).toPromise()}var Jy=800,Xy=3,Zy=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield ga(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Xy)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return jd()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=jy._getInstance(Hy()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield Wy(),!this.activeServiceWorker)return;this.sender=new ma(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||Gy()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield ga();return yield pd(t,Hi,"1"),yield md(t,Hi),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>pd(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>Yy(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>md(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(o=>{let a=Zi(o,!1).getAll();return new en(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:a}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),Jy)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Gd=Zy;var eb=Fd("rcb"),tb=new Zt(3e4,6e4);function ev(n,e){return e?ht(e):(M(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Pr=class extends Wi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ia(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ia(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ia(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function tv(n){return My(n.auth,new Pr(n),n.bypassAuthState)}function nv(n){let{auth:e,user:t}=n;return M(t,e,"internal-error"),Ly(t,new Pr(n),n.bypassAuthState)}function rv(n){return y(this,null,function*(){let{auth:e,user:t}=n;return M(t,e,"internal-error"),Vy(t,new Pr(n),n.bypassAuthState)})}var _a=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tv;case"linkViaPopup":case"linkViaRedirect":return rv;case"reauthViaPopup":case"reauthViaRedirect":return nv;default:xt(this.auth,"internal-error")}}resolve(e){Vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var nb=new Zt(2e3,1e4);var iv="pendingRedirect",Mi=new Map,ya=class n extends _a{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=Mi.get(this.auth._key());if(!e){try{let r=(yield sv(this.resolver,this.auth))?yield St(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Mi.set(this.auth._key(),e)}return this.bypassAuthState||Mi.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return St(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,St(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function sv(n,e){return y(this,null,function*(){let t=cv(e),r=av(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function ov(n,e){Mi.set(n._key(),e)}function av(n){return ht(n._redirectPersistence)}function cv(n){return Li(iv,n.config.apiKey,n.name)}function uv(n,e,t=!1){return y(this,null,function*(){if(Pe(n.app))return Promise.reject(Jt(n));let r=Ca(n),i=ev(r,e),a=yield new ya(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var lv=10*60*1e3,va=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hv(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Hd(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Xt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=lv&&this.cachedEventUids.clear(),this.cachedEventUids.has(gd(e))}saveEventToCache(e){this.cachedEventUids.add(gd(e)),this.lastProcessedEventTime=Date.now()}};function gd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Hd({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function hv(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Hd(n);default:return!1}}function dv(t){return y(this,arguments,function*(n,e={}){return vn(n,"GET","/v1/projects",e)})}var fv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pv=/^https?/;function mv(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield dv(n);for(let t of e)try{if(gv(t))return}catch{}xt(n,"unauthorized-domain")})}function gv(n){let e=oa(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!pv.test(t))return!1;if(fv.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var _v=new Zt(3e4,6e4);function _d(){let n=Ye().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function yv(n){return new Promise((e,t)=>{var r,i,o;function a(){_d(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_d(),t(Xt(n,"network-request-failed"))},timeout:_v.get()})}if(!((i=(r=Ye().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=Ye().gapi)===null||o===void 0)&&o.load)a();else{let u=Fd("iframefcb");return Ye()[u]=()=>{gapi.load?a():t(Xt(n,"network-request-failed"))},ky(`${Dy()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw Fi=null,e})}var Fi=null;function vv(n){return Fi=Fi||yv(n),Fi}var Iv=new Zt(5e3,15e3),Ev="__/auth/iframe",wv="emulator/auth/iframe",Tv={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Av=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function bv(n){let e=n.config;M(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Ta(e,wv):`https://${n.config.authDomain}/${Ev}`,r={apiKey:e.apiKey,appName:n.name,v:He},i=Av.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${yr(r).slice(1)}`}function Sv(n){return y(this,null,function*(){let e=yield vv(n),t=Ye().gapi;return M(t,n,"internal-error"),e.open({where:document.body,url:bv(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Tv,dontclear:!0},r=>new Promise((i,o)=>y(null,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=Xt(n,"network-request-failed"),u=Ye().setTimeout(()=>{o(a)},Iv.get());function h(){Ye().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(a)})})))})}var Rv={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Pv=500,Cv=600,kv="_blank",Dv="http://localhost",Yi=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Nv(n,e,t,r=Pv,i=Cv){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",h=Object.assign(Object.assign({},Rv),{width:r.toString(),height:i.toString(),top:o,left:a}),d=le().toLowerCase();t&&(u=Dd(d)?kv:t),Cd(d)&&(e=e||Dv,h.scrollbars="yes");let p=Object.entries(h).reduce((w,[R,D])=>`${w}${R}=${D},`,"");if(by(d)&&u!=="_self")return Ov(e||"",u),new Yi(null);let v=window.open(e||"",u,p);M(v,n,"popup-blocked");try{v.focus()}catch{}return new Yi(v)}function Ov(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var xv="__/auth/handler",Vv="emulator/auth/handler",Lv=encodeURIComponent("fac");function yd(n,e,t,r,i,o){return y(this,null,function*(){M(n.config.authDomain,n,"auth-domain-config-required"),M(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:He,eventId:i};if(e instanceof Gi){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Nh(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,v]of Object.entries(o||{}))a[p]=v}if(e instanceof fa){let p=e.getScopes().filter(v=>v!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let h=yield n._getAppCheckToken(),d=h?`#${Lv}=${encodeURIComponent(h)}`:"";return`${Mv(n)}?${yr(u).slice(1)}${d}`})}function Mv({config:n}){return n.emulator?Ta(n,Vv):`https://${n.authDomain}/${xv}`}var sa="webStorageSupport",Ia=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xa,this._completeRedirectFn=uv,this._overrideRedirectResult=ov}_openPopup(e,t,r,i){return y(this,null,function*(){var o;Vt((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let a=yield yd(e,t,r,oa(),i);return Nv(e,a,$d())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let o=yield yd(e,t,r,oa(),i);return zy(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Vt(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield Sv(e),r=new va(e);return t.register("authEvent",i=>(M(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(sa,{type:sa},i=>{var o;let a=(o=i?.[0])===null||o===void 0?void 0:o[sa];a!==void 0&&t(!!a),xt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=mv(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ld()||kd()||Pa()}},Kd=Ia;var vd="@firebase/auth",Id="1.10.4";var Ea=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){M(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Fv(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Uv(n){De(new me("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;M(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Md(n)},d=new da(r,i,o,h);return Ny(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),De(new me("auth-internal",e=>{let t=Ca(e.getProvider("auth").getImmediate());return(r=>new Ea(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),X(vd,Id,Fv(n)),X(vd,Id,"esm2017")}var Bv=5*60,qv=Oo("authIdTokenMaxAge")||Bv,Ed=null,$v=n=>e=>y(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>qv)return;let i=t?.token;Ed!==i&&(Ed=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Va(n=ct()){let e=Pt(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Da(n,{popupRedirectResolver:Kd,persistence:[Gd,qd,xa]}),r=Oo("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let a=$v(o.toString());Oa(t,a,()=>a(t.currentUser)),Ji(t,u=>a(u))}}let i=Do("auth");return i?Na(t,`http://${i}`):ot("Auth",!1),t}function jv(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Cy({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=Xt("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",jv().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Uv("Browser");function Yd(n){return new ke(function(e){var t=Xi(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var Jd="auth",tn=class{constructor(e){return e}},nn=class{constructor(){return Ct(Jd)}};var La=new $e("angularfire2.auth-instances");function VI(n,e){let t=Yt(Jd,n,e);return t&&new tn(t)}function LI(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new tn(r)}}var MI={provide:nn,deps:[[new pe,La]]},FI={provide:tn,useFactory:VI,deps:[[new pe,La],Fe]};function Xd(n,...e){return X("angularfire",Ke.full,"auth"),je([FI,MI,{provide:La,useFactory:LI(n),multi:!0,deps:[Se,Ne,Qe,ut,[new pe,Dt],...e]}])}var Zd=Oe(Yd,!0);var ef=Oe(Va,!0);var tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},nf={};var dt,Ma;(function(){var n;function e(E,m){function _(){}_.prototype=m.prototype,E.D=m.prototype,E.prototype=new _,E.prototype.constructor=E,E.C=function(I,T,b){for(var g=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)g[nt-2]=arguments[nt];return m.prototype[T].apply(I,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,m,_){_||(_=0);var I=Array(16);if(typeof m=="string")for(var T=0;16>T;++T)I[T]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(T=0;16>T;++T)I[T]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=E.g[0],_=E.g[1],T=E.g[2];var b=E.g[3],g=m+(b^_&(T^b))+I[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=b+(T^m&(_^T))+I[1]+3905402710&4294967295,b=m+(g<<12&4294967295|g>>>20),g=T+(_^b&(m^_))+I[2]+606105819&4294967295,T=b+(g<<17&4294967295|g>>>15),g=_+(m^T&(b^m))+I[3]+3250441966&4294967295,_=T+(g<<22&4294967295|g>>>10),g=m+(b^_&(T^b))+I[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(T^m&(_^T))+I[5]+1200080426&4294967295,b=m+(g<<12&4294967295|g>>>20),g=T+(_^b&(m^_))+I[6]+2821735955&4294967295,T=b+(g<<17&4294967295|g>>>15),g=_+(m^T&(b^m))+I[7]+4249261313&4294967295,_=T+(g<<22&4294967295|g>>>10),g=m+(b^_&(T^b))+I[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(T^m&(_^T))+I[9]+2336552879&4294967295,b=m+(g<<12&4294967295|g>>>20),g=T+(_^b&(m^_))+I[10]+4294925233&4294967295,T=b+(g<<17&4294967295|g>>>15),g=_+(m^T&(b^m))+I[11]+2304563134&4294967295,_=T+(g<<22&4294967295|g>>>10),g=m+(b^_&(T^b))+I[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(T^m&(_^T))+I[13]+4254626195&4294967295,b=m+(g<<12&4294967295|g>>>20),g=T+(_^b&(m^_))+I[14]+2792965006&4294967295,T=b+(g<<17&4294967295|g>>>15),g=_+(m^T&(b^m))+I[15]+1236535329&4294967295,_=T+(g<<22&4294967295|g>>>10),g=m+(T^b&(_^T))+I[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^T&(m^_))+I[6]+3225465664&4294967295,b=m+(g<<9&4294967295|g>>>23),g=T+(m^_&(b^m))+I[11]+643717713&4294967295,T=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(T^b))+I[0]+3921069994&4294967295,_=T+(g<<20&4294967295|g>>>12),g=m+(T^b&(_^T))+I[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^T&(m^_))+I[10]+38016083&4294967295,b=m+(g<<9&4294967295|g>>>23),g=T+(m^_&(b^m))+I[15]+3634488961&4294967295,T=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(T^b))+I[4]+3889429448&4294967295,_=T+(g<<20&4294967295|g>>>12),g=m+(T^b&(_^T))+I[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^T&(m^_))+I[14]+3275163606&4294967295,b=m+(g<<9&4294967295|g>>>23),g=T+(m^_&(b^m))+I[3]+4107603335&4294967295,T=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(T^b))+I[8]+1163531501&4294967295,_=T+(g<<20&4294967295|g>>>12),g=m+(T^b&(_^T))+I[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^T&(m^_))+I[2]+4243563512&4294967295,b=m+(g<<9&4294967295|g>>>23),g=T+(m^_&(b^m))+I[7]+1735328473&4294967295,T=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(T^b))+I[12]+2368359562&4294967295,_=T+(g<<20&4294967295|g>>>12),g=m+(_^T^b)+I[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^T)+I[8]+2272392833&4294967295,b=m+(g<<11&4294967295|g>>>21),g=T+(b^m^_)+I[11]+1839030562&4294967295,T=b+(g<<16&4294967295|g>>>16),g=_+(T^b^m)+I[14]+4259657740&4294967295,_=T+(g<<23&4294967295|g>>>9),g=m+(_^T^b)+I[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^T)+I[4]+1272893353&4294967295,b=m+(g<<11&4294967295|g>>>21),g=T+(b^m^_)+I[7]+4139469664&4294967295,T=b+(g<<16&4294967295|g>>>16),g=_+(T^b^m)+I[10]+3200236656&4294967295,_=T+(g<<23&4294967295|g>>>9),g=m+(_^T^b)+I[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^T)+I[0]+3936430074&4294967295,b=m+(g<<11&4294967295|g>>>21),g=T+(b^m^_)+I[3]+3572445317&4294967295,T=b+(g<<16&4294967295|g>>>16),g=_+(T^b^m)+I[6]+76029189&4294967295,_=T+(g<<23&4294967295|g>>>9),g=m+(_^T^b)+I[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^T)+I[12]+3873151461&4294967295,b=m+(g<<11&4294967295|g>>>21),g=T+(b^m^_)+I[15]+530742520&4294967295,T=b+(g<<16&4294967295|g>>>16),g=_+(T^b^m)+I[2]+3299628645&4294967295,_=T+(g<<23&4294967295|g>>>9),g=m+(T^(_|~b))+I[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~T))+I[7]+1126891415&4294967295,b=m+(g<<10&4294967295|g>>>22),g=T+(m^(b|~_))+I[14]+2878612391&4294967295,T=b+(g<<15&4294967295|g>>>17),g=_+(b^(T|~m))+I[5]+4237533241&4294967295,_=T+(g<<21&4294967295|g>>>11),g=m+(T^(_|~b))+I[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~T))+I[3]+2399980690&4294967295,b=m+(g<<10&4294967295|g>>>22),g=T+(m^(b|~_))+I[10]+4293915773&4294967295,T=b+(g<<15&4294967295|g>>>17),g=_+(b^(T|~m))+I[1]+2240044497&4294967295,_=T+(g<<21&4294967295|g>>>11),g=m+(T^(_|~b))+I[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~T))+I[15]+4264355552&4294967295,b=m+(g<<10&4294967295|g>>>22),g=T+(m^(b|~_))+I[6]+2734768916&4294967295,T=b+(g<<15&4294967295|g>>>17),g=_+(b^(T|~m))+I[13]+1309151649&4294967295,_=T+(g<<21&4294967295|g>>>11),g=m+(T^(_|~b))+I[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~T))+I[11]+3174756917&4294967295,b=m+(g<<10&4294967295|g>>>22),g=T+(m^(b|~_))+I[2]+718787259&4294967295,T=b+(g<<15&4294967295|g>>>17),g=_+(b^(T|~m))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+m&4294967295,E.g[1]=E.g[1]+(T+(g<<21&4294967295|g>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+b&4294967295}r.prototype.u=function(E,m){m===void 0&&(m=E.length);for(var _=m-this.blockSize,I=this.B,T=this.h,b=0;b<m;){if(T==0)for(;b<=_;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<m;)if(I[T++]=E.charCodeAt(b++),T==this.blockSize){i(this,I),T=0;break}}else for(;b<m;)if(I[T++]=E[b++],T==this.blockSize){i(this,I),T=0;break}}this.h=T,this.o+=m},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var m=1;m<E.length-8;++m)E[m]=0;var _=8*this.o;for(m=E.length-8;m<E.length;++m)E[m]=_&255,_/=256;for(this.u(E),E=Array(16),m=_=0;4>m;++m)for(var I=0;32>I;I+=8)E[_++]=this.g[m]>>>I&255;return E};function o(E,m){var _=u;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=m(E)}function a(E,m){this.h=m;for(var _=[],I=!0,T=E.length-1;0<=T;T--){var b=E[T]|0;I&&b==m||(_[T]=b,I=!1)}this.g=_}var u={};function h(E){return-128<=E&&128>E?o(E,function(m){return new a([m|0],0>m?-1:0)}):new a([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return v;if(0>E)return C(d(-E));for(var m=[],_=1,I=0;E>=_;I++)m[I]=E/_|0,_*=4294967296;return new a(m,0)}function p(E,m){if(E.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(E.charAt(0)=="-")return C(p(E.substring(1),m));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),I=v,T=0;T<E.length;T+=8){var b=Math.min(8,E.length-T),g=parseInt(E.substring(T,T+b),m);8>b?(b=d(Math.pow(m,b)),I=I.j(b).add(d(g))):(I=I.j(_),I=I.add(d(g)))}return I}var v=h(0),w=h(1),R=h(16777216);n=a.prototype,n.m=function(){if(x(this))return-C(this).m();for(var E=0,m=1,_=0;_<this.g.length;_++){var I=this.i(_);E+=(0<=I?I:4294967296+I)*m,m*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(D(this))return"0";if(x(this))return"-"+C(this).toString(E);for(var m=d(Math.pow(E,6)),_=this,I="";;){var T=$(_,m).g;_=j(_,T.j(m));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(E);if(_=T,D(_))return b+I;for(;6>b.length;)b="0"+b;I=b+I}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function D(E){if(E.h!=0)return!1;for(var m=0;m<E.g.length;m++)if(E.g[m]!=0)return!1;return!0}function x(E){return E.h==-1}n.l=function(E){return E=j(this,E),x(E)?-1:D(E)?0:1};function C(E){for(var m=E.g.length,_=[],I=0;I<m;I++)_[I]=~E.g[I];return new a(_,~E.h).add(w)}n.abs=function(){return x(this)?C(this):this},n.add=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0,T=0;T<=m;T++){var b=I+(this.i(T)&65535)+(E.i(T)&65535),g=(b>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);I=g>>>16,b&=65535,g&=65535,_[T]=g<<16|b}return new a(_,_[_.length-1]&-2147483648?-1:0)};function j(E,m){return E.add(C(m))}n.j=function(E){if(D(this)||D(E))return v;if(x(this))return x(E)?C(this).j(C(E)):C(C(this).j(E));if(x(E))return C(this.j(C(E)));if(0>this.l(R)&&0>E.l(R))return d(this.m()*E.m());for(var m=this.g.length+E.g.length,_=[],I=0;I<2*m;I++)_[I]=0;for(I=0;I<this.g.length;I++)for(var T=0;T<E.g.length;T++){var b=this.i(I)>>>16,g=this.i(I)&65535,nt=E.i(T)>>>16,Kn=E.i(T)&65535;_[2*I+2*T]+=g*Kn,q(_,2*I+2*T),_[2*I+2*T+1]+=b*Kn,q(_,2*I+2*T+1),_[2*I+2*T+1]+=g*nt,q(_,2*I+2*T+1),_[2*I+2*T+2]+=b*nt,q(_,2*I+2*T+2)}for(I=0;I<m;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=m;I<2*m;I++)_[I]=0;return new a(_,0)};function q(E,m){for(;(E[m]&65535)!=E[m];)E[m+1]+=E[m]>>>16,E[m]&=65535,m++}function U(E,m){this.g=E,this.h=m}function $(E,m){if(D(m))throw Error("division by zero");if(D(E))return new U(v,v);if(x(E))return m=$(C(E),m),new U(C(m.g),C(m.h));if(x(m))return m=$(E,C(m)),new U(C(m.g),m.h);if(30<E.g.length){if(x(E)||x(m))throw Error("slowDivide_ only works with positive integers.");for(var _=w,I=m;0>=I.l(E);)_=se(_),I=se(I);var T=K(_,1),b=K(I,1);for(I=K(I,2),_=K(_,2);!D(I);){var g=b.add(I);0>=g.l(E)&&(T=T.add(_),b=g),I=K(I,1),_=K(_,1)}return m=j(E,T.j(m)),new U(T,m)}for(T=v;0<=E.l(m);){for(_=Math.max(1,Math.floor(E.m()/m.m())),I=Math.ceil(Math.log(_)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),b=d(_),g=b.j(m);x(g)||0<g.l(E);)_-=I,b=d(_),g=b.j(m);D(b)&&(b=w),T=T.add(b),E=j(E,g)}return new U(T,E)}n.A=function(E){return $(this,E).h},n.and=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)&E.i(I);return new a(_,this.h&E.h)},n.or=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)|E.i(I);return new a(_,this.h|E.h)},n.xor=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)^E.i(I);return new a(_,this.h^E.h)};function se(E){for(var m=E.g.length+1,_=[],I=0;I<m;I++)_[I]=E.i(I)<<1|E.i(I-1)>>>31;return new a(_,E.h)}function K(E,m){var _=m>>5;m%=32;for(var I=E.g.length-_,T=[],b=0;b<I;b++)T[b]=0<m?E.i(b+_)>>>m|E.i(b+_+1)<<32-m:E.i(b+_);return new a(T,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Ma=nf.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,dt=nf.Integer=a}).apply(typeof tf<"u"?tf:typeof self<"u"?self:typeof window<"u"?window:{});var es=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ft={};var Fa,UI,In,Ua,Cr,ts,Ba,qa,$a;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof es=="object"&&es];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var A=s[f];if(!(A in l))break e;l=l[A]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,A={next:function(){if(!f&&l<s.length){var S=l++;return{value:c(S,s[S]),done:!1}}return f=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function p(s,c,l){return s.call.apply(s.bind,arguments)}function v(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,f),s.apply(c,A)}}return function(){return s.apply(c,arguments)}}function w(s,c,l){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:v,w.apply(null,arguments)}function R(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function D(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,A,S){for(var k=Array(arguments.length-2),J=2;J<arguments.length;J++)k[J-2]=arguments[J];return c.prototype[A].apply(f,k)}}function x(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function C(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let A=s.length||0,S=f.length||0;s.length=A+S;for(let k=0;k<S;k++)s[A+k]=f[k]}else s.push(f)}}class j{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function q(s){return/^[\s\xa0]*$/.test(s)}function U(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function $(s){return $[" "](s),s}$[" "]=function(){};var se=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function K(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function E(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function m(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(s,c){let l,f;for(let A=1;A<arguments.length;A++){f=arguments[A];for(l in f)s[l]=f[l];for(let S=0;S<_.length;S++)l=_[S],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function T(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function b(s){u.setTimeout(()=>{throw s},0)}function g(){var s=Gs;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class nt{constructor(){this.h=this.g=null}add(c,l){let f=Kn.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var Kn=new j(()=>new Lm,s=>s.reset());class Lm{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let Qn,Yn=!1,Gs=new nt,tl=()=>{let s=u.Promise.resolve(void 0);Qn=()=>{s.then(Mm)}};var Mm=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){b(l)}var c=Kn;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}Yn=!1};function wt(){this.s=this.s,this.C=this.C}wt.prototype.s=!1,wt.prototype.ma=function(){this.s||(this.s=!0,this.N())},wt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ge(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}ge.prototype.h=function(){this.defaultPrevented=!0};var Fm=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s}();function Jn(s,c){if(ge.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(se){e:{try{$(c.nodeName);var A=!0;break e}catch{}A=!1}A||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:Um[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&Jn.aa.h.call(this)}}D(Jn,ge);var Um={2:"touch",3:"pen",4:"mouse"};Jn.prototype.h=function(){Jn.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var Xn="closure_listenable_"+(1e6*Math.random()|0),Bm=0;function qm(s,c,l,f,A){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=A,this.key=++Bm,this.da=this.fa=!1}function ni(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function ri(s){this.src=s,this.g={},this.h=0}ri.prototype.add=function(s,c,l,f,A){var S=s.toString();s=this.g[S],s||(s=this.g[S]=[],this.h++);var k=Ks(s,c,f,A);return-1<k?(c=s[k],l||(c.fa=!1)):(c=new qm(c,this.src,S,!!f,A),c.fa=l,s.push(c)),c};function Hs(s,c){var l=c.type;if(l in s.g){var f=s.g[l],A=Array.prototype.indexOf.call(f,c,void 0),S;(S=0<=A)&&Array.prototype.splice.call(f,A,1),S&&(ni(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function Ks(s,c,l,f){for(var A=0;A<s.length;++A){var S=s[A];if(!S.da&&S.listener==c&&S.capture==!!l&&S.ha==f)return A}return-1}var Qs="closure_lm_"+(1e6*Math.random()|0),Ys={};function nl(s,c,l,f,A){if(f&&f.once)return il(s,c,l,f,A);if(Array.isArray(c)){for(var S=0;S<c.length;S++)nl(s,c[S],l,f,A);return null}return l=eo(l),s&&s[Xn]?s.K(c,l,d(f)?!!f.capture:!!f,A):rl(s,c,l,!1,f,A)}function rl(s,c,l,f,A,S){if(!c)throw Error("Invalid event type");var k=d(A)?!!A.capture:!!A,J=Xs(s);if(J||(s[Qs]=J=new ri(s)),l=J.add(c,l,f,k,S),l.proxy)return l;if(f=$m(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)Fm||(A=k),A===void 0&&(A=!1),s.addEventListener(c.toString(),f,A);else if(s.attachEvent)s.attachEvent(ol(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function $m(){function s(l){return c.call(s.src,s.listener,l)}let c=jm;return s}function il(s,c,l,f,A){if(Array.isArray(c)){for(var S=0;S<c.length;S++)il(s,c[S],l,f,A);return null}return l=eo(l),s&&s[Xn]?s.L(c,l,d(f)?!!f.capture:!!f,A):rl(s,c,l,!0,f,A)}function sl(s,c,l,f,A){if(Array.isArray(c))for(var S=0;S<c.length;S++)sl(s,c[S],l,f,A);else f=d(f)?!!f.capture:!!f,l=eo(l),s&&s[Xn]?(s=s.i,c=String(c).toString(),c in s.g&&(S=s.g[c],l=Ks(S,l,f,A),-1<l&&(ni(S[l]),Array.prototype.splice.call(S,l,1),S.length==0&&(delete s.g[c],s.h--)))):s&&(s=Xs(s))&&(c=s.g[c.toString()],s=-1,c&&(s=Ks(c,l,f,A)),(l=-1<s?c[s]:null)&&Js(l))}function Js(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[Xn])Hs(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(ol(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=Xs(c))?(Hs(l,s),l.h==0&&(l.src=null,c[Qs]=null)):ni(s)}}}function ol(s){return s in Ys?Ys[s]:Ys[s]="on"+s}function jm(s,c){if(s.da)s=!0;else{c=new Jn(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&Js(s),s=l.call(f,c)}return s}function Xs(s){return s=s[Qs],s instanceof ri?s:null}var Zs="__closure_events_fn_"+(1e9*Math.random()>>>0);function eo(s){return typeof s=="function"?s:(s[Zs]||(s[Zs]=function(c){return s.handleEvent(c)}),s[Zs])}function _e(){wt.call(this),this.i=new ri(this),this.M=this,this.F=null}D(_e,wt),_e.prototype[Xn]=!0,_e.prototype.removeEventListener=function(s,c,l,f){sl(this,s,c,l,f)};function we(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new ge(c,s);else if(c instanceof ge)c.target=c.target||s;else{var A=c;c=new ge(f,s),I(c,A)}if(A=!0,l)for(var S=l.length-1;0<=S;S--){var k=c.g=l[S];A=ii(k,f,!0,c)&&A}if(k=c.g=s,A=ii(k,f,!0,c)&&A,A=ii(k,f,!1,c)&&A,l)for(S=0;S<l.length;S++)k=c.g=l[S],A=ii(k,f,!1,c)&&A}_e.prototype.N=function(){if(_e.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)ni(l[f]);delete s.g[c],s.h--}}this.F=null},_e.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},_e.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function ii(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var A=!0,S=0;S<c.length;++S){var k=c[S];if(k&&!k.da&&k.capture==l){var J=k.listener,fe=k.ha||k.src;k.fa&&Hs(s.i,k),A=J.call(fe,f)!==!1&&A}}return A&&!f.defaultPrevented}function al(s,c,l){if(typeof s=="function")l&&(s=w(s,l));else if(s&&typeof s.handleEvent=="function")s=w(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function cl(s){s.g=al(()=>{s.g=null,s.i&&(s.i=!1,cl(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class zm extends wt{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:cl(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zn(s){wt.call(this),this.h=s,this.g={}}D(Zn,wt);var ul=[];function ll(s){K(s.g,function(c,l){this.g.hasOwnProperty(l)&&Js(c)},s),s.g={}}Zn.prototype.N=function(){Zn.aa.N.call(this),ll(this)},Zn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var to=u.JSON.stringify,Wm=u.JSON.parse,Gm=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function no(){}no.prototype.h=null;function hl(s){return s.h||(s.h=s.i())}function dl(){}var er={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ro(){ge.call(this,"d")}D(ro,ge);function io(){ge.call(this,"c")}D(io,ge);var Bt={},fl=null;function si(){return fl=fl||new _e}Bt.La="serverreachability";function pl(s){ge.call(this,Bt.La,s)}D(pl,ge);function tr(s){let c=si();we(c,new pl(c))}Bt.STAT_EVENT="statevent";function ml(s,c){ge.call(this,Bt.STAT_EVENT,s),this.stat=c}D(ml,ge);function Te(s){let c=si();we(c,new ml(c,s))}Bt.Ma="timingevent";function gl(s,c){ge.call(this,Bt.Ma,s),this.size=c}D(gl,ge);function nr(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function rr(){this.g=!0}rr.prototype.xa=function(){this.g=!1};function Hm(s,c,l,f,A,S){s.info(function(){if(s.g)if(S)for(var k="",J=S.split("&"),fe=0;fe<J.length;fe++){var Y=J[fe].split("=");if(1<Y.length){var ye=Y[0];Y=Y[1];var ve=ye.split("_");k=2<=ve.length&&ve[1]=="type"?k+(ye+"="+Y+"&"):k+(ye+"=redacted&")}}else k=null;else k=S;return"XMLHTTP REQ ("+f+") [attempt "+A+"]: "+c+`
`+l+`
`+k})}function Km(s,c,l,f,A,S,k){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+A+"]: "+c+`
`+l+`
`+S+" "+k})}function hn(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+Ym(s,l)+(f?" "+f:"")})}function Qm(s,c){s.info(function(){return"TIMEOUT: "+c})}rr.prototype.info=function(){};function Ym(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var A=f[1];if(Array.isArray(A)&&!(1>A.length)){var S=A[0];if(S!="noop"&&S!="stop"&&S!="close")for(var k=1;k<A.length;k++)A[k]=""}}}}return to(l)}catch{return c}}var oi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_l={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},so;function ai(){}D(ai,no),ai.prototype.g=function(){return new XMLHttpRequest},ai.prototype.i=function(){return{}},so=new ai;function Tt(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new Zn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new yl}function yl(){this.i=null,this.g="",this.h=!1}var vl={},oo={};function ao(s,c,l){s.L=1,s.v=hi(rt(c)),s.m=l,s.P=!0,Il(s,null)}function Il(s,c){s.F=Date.now(),ci(s),s.A=rt(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),xl(l.i,"t",f),s.C=0,l=s.j.J,s.h=new yl,s.g=Xl(s.j,l?c:null,!s.m),0<s.O&&(s.M=new zm(w(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var A="readystatechange";Array.isArray(A)||(A&&(ul[0]=A.toString()),A=ul);for(var S=0;S<A.length;S++){var k=nl(l,A[S],f||c.handleEvent,!1,c.h||c);if(!k)break;c.g[k.key]=k}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),tr(),Hm(s.i,s.u,s.A,s.l,s.R,s.m)}Tt.prototype.ca=function(s){s=s.target;let c=this.M;c&&it(s)==3?c.j():this.Y(s)},Tt.prototype.Y=function(s){try{if(s==this.g)e:{let ve=it(this.g);var c=this.g.Ba();let pn=this.g.Z();if(!(3>ve)&&(ve!=3||this.g&&(this.h.h||this.g.oa()||ql(this.g)))){this.J||ve!=4||c==7||(c==8||0>=pn?tr(3):tr(2)),co(this);var l=this.g.Z();this.X=l;t:if(El(this)){var f=ql(this.g);s="";var A=f.length,S=it(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qt(this),ir(this);var k="";break t}this.h.i=new u.TextDecoder}for(c=0;c<A;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(S&&c==A-1)});f.length=0,this.h.g+=s,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=l==200,Km(this.i,this.u,this.A,this.l,this.R,ve,l),this.o){if(this.T&&!this.K){t:{if(this.g){var J,fe=this.g;if((J=fe.g?fe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(J)){var Y=J;break t}}Y=null}if(l=Y)hn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,uo(this,l);else{this.o=!1,this.s=3,Te(12),qt(this),ir(this);break e}}if(this.P){l=!0;let Le;for(;!this.J&&this.C<k.length;)if(Le=Jm(this,k),Le==oo){ve==4&&(this.s=4,Te(14),l=!1),hn(this.i,this.l,null,"[Incomplete Response]");break}else if(Le==vl){this.s=4,Te(15),hn(this.i,this.l,k,"[Invalid Chunk]"),l=!1;break}else hn(this.i,this.l,Le,null),uo(this,Le);if(El(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ve!=4||k.length!=0||this.h.h||(this.s=1,Te(16),l=!1),this.o=this.o&&l,!l)hn(this.i,this.l,k,"[Invalid Chunked Response]"),qt(this),ir(this);else if(0<k.length&&!this.W){this.W=!0;var ye=this.j;ye.g==this&&ye.ba&&!ye.M&&(ye.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),go(ye),ye.M=!0,Te(11))}}else hn(this.i,this.l,k,null),uo(this,k);ve==4&&qt(this),this.o&&!this.J&&(ve==4?Kl(this.j,this):(this.o=!1,ci(this)))}else pg(this.g),l==400&&0<k.indexOf("Unknown SID")?(this.s=3,Te(12)):(this.s=0,Te(13)),qt(this),ir(this)}}}catch{}finally{}};function El(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function Jm(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?oo:(l=Number(c.substring(l,f)),isNaN(l)?vl:(f+=1,f+l>c.length?oo:(c=c.slice(f,f+l),s.C=f+l,c)))}Tt.prototype.cancel=function(){this.J=!0,qt(this)};function ci(s){s.S=Date.now()+s.I,wl(s,s.I)}function wl(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=nr(w(s.ba,s),c)}function co(s){s.B&&(u.clearTimeout(s.B),s.B=null)}Tt.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(Qm(this.i,this.A),this.L!=2&&(tr(),Te(17)),qt(this),this.s=2,ir(this)):wl(this,this.S-s)};function ir(s){s.j.G==0||s.J||Kl(s.j,s)}function qt(s){co(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,ll(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function uo(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||lo(l.h,s))){if(!s.K&&lo(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var A=f;if(A[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)gi(l),pi(l);else break e;mo(l),Te(18)}}else l.za=A[1],0<l.za-l.T&&37500>A[2]&&l.F&&l.v==0&&!l.C&&(l.C=nr(w(l.Za,l),6e3));if(1>=bl(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else jt(l,11)}else if((s.K||l.g==s)&&gi(l),!q(c))for(A=l.Da.g.parse(c),c=0;c<A.length;c++){let Y=A[c];if(l.T=Y[0],Y=Y[1],l.G==2)if(Y[0]=="c"){l.K=Y[1],l.ia=Y[2];let ye=Y[3];ye!=null&&(l.la=ye,l.j.info("VER="+l.la));let ve=Y[4];ve!=null&&(l.Aa=ve,l.j.info("SVER="+l.Aa));let pn=Y[5];pn!=null&&typeof pn=="number"&&0<pn&&(f=1.5*pn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let Le=s.g;if(Le){let yi=Le.g?Le.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yi){var S=f.h;S.g||yi.indexOf("spdy")==-1&&yi.indexOf("quic")==-1&&yi.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(ho(S,S.h),S.h=null))}if(f.D){let _o=Le.g?Le.g.getResponseHeader("X-HTTP-Session-Id"):null;_o&&(f.ya=_o,Z(f.I,f.D,_o))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var k=s;if(f.qa=Jl(f,f.J?f.ia:null,f.W),k.K){Sl(f.h,k);var J=k,fe=f.L;fe&&(J.I=fe),J.B&&(co(J),ci(J)),f.g=k}else Gl(f);0<l.i.length&&mi(l)}else Y[0]!="stop"&&Y[0]!="close"||jt(l,7);else l.G==3&&(Y[0]=="stop"||Y[0]=="close"?Y[0]=="stop"?jt(l,7):po(l):Y[0]!="noop"&&l.l&&l.l.ta(Y),l.v=0)}}tr(4)}catch{}}var Xm=class{constructor(s,c){this.g=s,this.map=c}};function Tl(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Al(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function bl(s){return s.h?1:s.g?s.g.size:0}function lo(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function ho(s,c){s.g?s.g.add(c):s.h=c}function Sl(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}Tl.prototype.cancel=function(){if(this.i=Rl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Rl(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return x(s.i)}function Zm(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function eg(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function Pl(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=eg(s),f=Zm(s),A=f.length,S=0;S<A;S++)c.call(void 0,f[S],l&&l[S],s)}var Cl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tg(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),A=null;if(0<=f){var S=s[l].substring(0,f);A=s[l].substring(f+1)}else S=s[l];c(S,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function $t(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof $t){this.h=s.h,ui(this,s.j),this.o=s.o,this.g=s.g,li(this,s.s),this.l=s.l;var c=s.i,l=new ar;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),kl(this,l),this.m=s.m}else s&&(c=String(s).match(Cl))?(this.h=!1,ui(this,c[1]||"",!0),this.o=sr(c[2]||""),this.g=sr(c[3]||"",!0),li(this,c[4]),this.l=sr(c[5]||"",!0),kl(this,c[6]||"",!0),this.m=sr(c[7]||"")):(this.h=!1,this.i=new ar(null,this.h))}$t.prototype.toString=function(){var s=[],c=this.j;c&&s.push(or(c,Dl,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(or(c,Dl,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(or(l,l.charAt(0)=="/"?ig:rg,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",or(l,og)),s.join("")};function rt(s){return new $t(s)}function ui(s,c,l){s.j=l?sr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function li(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function kl(s,c,l){c instanceof ar?(s.i=c,ag(s.i,s.h)):(l||(c=or(c,sg)),s.i=new ar(c,s.h))}function Z(s,c,l){s.i.set(c,l)}function hi(s){return Z(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function sr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function or(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,ng),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function ng(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Dl=/[#\/\?@]/g,rg=/[#\?:]/g,ig=/[#\?]/g,sg=/[#\?@]/g,og=/#/g;function ar(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function At(s){s.g||(s.g=new Map,s.h=0,s.i&&tg(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=ar.prototype,n.add=function(s,c){At(this),this.i=null,s=dn(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function Nl(s,c){At(s),c=dn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function Ol(s,c){return At(s),c=dn(s,c),s.g.has(c)}n.forEach=function(s,c){At(this),this.g.forEach(function(l,f){l.forEach(function(A){s.call(c,A,f,this)},this)},this)},n.na=function(){At(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let A=s[f];for(let S=0;S<A.length;S++)l.push(c[f])}return l},n.V=function(s){At(this);let c=[];if(typeof s=="string")Ol(this,s)&&(c=c.concat(this.g.get(dn(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return At(this),this.i=null,s=dn(this,s),Ol(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function xl(s,c,l){Nl(s,c),0<l.length&&(s.i=null,s.g.set(dn(s,c),x(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let S=encodeURIComponent(String(f)),k=this.V(f);for(f=0;f<k.length;f++){var A=S;k[f]!==""&&(A+="="+encodeURIComponent(String(k[f]))),s.push(A)}}return this.i=s.join("&")};function dn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function ag(s,c){c&&!s.j&&(At(s),s.i=null,s.g.forEach(function(l,f){var A=f.toLowerCase();f!=A&&(Nl(this,f),xl(this,A,l))},s)),s.j=c}function cg(s,c){let l=new rr;if(u.Image){let f=new Image;f.onload=R(bt,l,"TestLoadImage: loaded",!0,c,f),f.onerror=R(bt,l,"TestLoadImage: error",!1,c,f),f.onabort=R(bt,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=R(bt,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function ug(s,c){let l=new rr,f=new AbortController,A=setTimeout(()=>{f.abort(),bt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(S=>{clearTimeout(A),S.ok?bt(l,"TestPingServer: ok",!0,c):bt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(A),bt(l,"TestPingServer: error",!1,c)})}function bt(s,c,l,f,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),f(l)}catch{}}function lg(){this.g=new Gm}function hg(s,c,l){let f=l||"";try{Pl(s,function(A,S){let k=A;d(A)&&(k=to(A)),c.push(f+S+"="+encodeURIComponent(k))})}catch(A){throw c.push(f+"type="+encodeURIComponent("_badmap")),A}}function cr(s){this.l=s.Ub||null,this.j=s.eb||!1}D(cr,no),cr.prototype.g=function(){return new di(this.l,this.j)},cr.prototype.i=function(s){return function(){return s}}({});function di(s,c){_e.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(di,_e),n=di.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,lr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ur(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,lr(this)),this.g&&(this.readyState=3,lr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vl(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vl(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?ur(this):lr(this),this.readyState==3&&Vl(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,ur(this))},n.Qa=function(s){this.g&&(this.response=s,ur(this))},n.ga=function(){this.g&&ur(this)};function ur(s){s.readyState=4,s.l=null,s.j=null,s.v=null,lr(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function lr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Ll(s){let c="";return K(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function fo(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=Ll(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):Z(s,c,l))}function ne(s){_e.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(ne,_e);var dg=/^https?$/i,fg=["POST","PUT"];n=ne.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():so.g(),this.v=this.o?hl(this.o):hl(so),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(S){Ml(this,S);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var A in f)l.set(A,f[A]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let S of f.keys())l.set(S,f.get(S));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(S=>S.toLowerCase()=="content-type"),A=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(fg,c,void 0))||f||A||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,k]of l)this.g.setRequestHeader(S,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Bl(this),this.u=!0,this.g.send(s),this.u=!1}catch(S){Ml(this,S)}};function Ml(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,Fl(s),fi(s)}function Fl(s){s.A||(s.A=!0,we(s,"complete"),we(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,we(this,"complete"),we(this,"abort"),fi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fi(this,!0)),ne.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ul(this):this.bb())},n.bb=function(){Ul(this)};function Ul(s){if(s.h&&typeof a<"u"&&(!s.v[1]||it(s)!=4||s.Z()!=2)){if(s.u&&it(s)==4)al(s.Ea,0,s);else if(we(s,"readystatechange"),it(s)==4){s.h=!1;try{let k=s.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=k===0){var A=String(s.D).match(Cl)[1]||null;!A&&u.self&&u.self.location&&(A=u.self.location.protocol.slice(0,-1)),f=!dg.test(A?A.toLowerCase():"")}l=f}if(l)we(s,"complete"),we(s,"success");else{s.m=6;try{var S=2<it(s)?s.g.statusText:""}catch{S=""}s.l=S+" ["+s.Z()+"]",Fl(s)}}finally{fi(s)}}}}function fi(s,c){if(s.g){Bl(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||we(s,"ready");try{l.onreadystatechange=f}catch{}}}function Bl(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function it(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<it(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Wm(c)}};function ql(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function pg(s){let c={};s=(s.g&&2<=it(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(q(s[f]))continue;var l=T(s[f]);let A=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let S=c[A]||[];c[A]=S,S.push(l)}E(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function hr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function $l(s){this.Aa=0,this.i=[],this.j=new rr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=hr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=hr("baseRetryDelayMs",5e3,s),this.cb=hr("retryDelaySeedMs",1e4,s),this.Wa=hr("forwardChannelMaxRetries",2,s),this.wa=hr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new Tl(s&&s.concurrentRequestLimit),this.Da=new lg,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=$l.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){Te(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=Jl(this,null,this.W),mi(this)};function po(s){if(jl(s),s.G==3){var c=s.U++,l=rt(s.I);if(Z(l,"SID",s.K),Z(l,"RID",c),Z(l,"TYPE","terminate"),dr(s,l),c=new Tt(s,s.j,c),c.L=2,c.v=hi(rt(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=Xl(c.j,null),c.g.ea(c.v)),c.F=Date.now(),ci(c)}Yl(s)}function pi(s){s.g&&(go(s),s.g.cancel(),s.g=null)}function jl(s){pi(s),s.u&&(u.clearTimeout(s.u),s.u=null),gi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function mi(s){if(!Al(s.h)&&!s.s){s.s=!0;var c=s.Ga;Qn||tl(),Yn||(Qn(),Yn=!0),Gs.add(c,s),s.B=0}}function mg(s,c){return bl(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=nr(w(s.Ga,s,c),Ql(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let A=new Tt(this,this.j,s),S=this.o;if(this.S&&(S?(S=m(S),I(S,this.S)):S=this.S),this.m!==null||this.O||(A.H=S,S=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=Wl(this,A,c),l=rt(this.I),Z(l,"RID",s),Z(l,"CVER",22),this.D&&Z(l,"X-HTTP-Session-Id",this.D),dr(this,l),S&&(this.O?c="headers="+encodeURIComponent(String(Ll(S)))+"&"+c:this.m&&fo(l,this.m,S)),ho(this.h,A),this.Ua&&Z(l,"TYPE","init"),this.P?(Z(l,"$req",c),Z(l,"SID","null"),A.T=!0,ao(A,l,null)):ao(A,l,c),this.G=2}}else this.G==3&&(s?zl(this,s):this.i.length==0||Al(this.h)||zl(this))};function zl(s,c){var l;c?l=c.l:l=s.U++;let f=rt(s.I);Z(f,"SID",s.K),Z(f,"RID",l),Z(f,"AID",s.T),dr(s,f),s.m&&s.o&&fo(f,s.m,s.o),l=new Tt(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=Wl(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),ho(s.h,l),ao(l,f,c)}function dr(s,c){s.H&&K(s.H,function(l,f){Z(c,f,l)}),s.l&&Pl({},function(l,f){Z(c,f,l)})}function Wl(s,c,l){l=Math.min(s.i.length,l);var f=s.l?w(s.l.Na,s.l,s):null;e:{var A=s.i;let S=-1;for(;;){let k=["count="+l];S==-1?0<l?(S=A[0].g,k.push("ofs="+S)):S=0:k.push("ofs="+S);let J=!0;for(let fe=0;fe<l;fe++){let Y=A[fe].g,ye=A[fe].map;if(Y-=S,0>Y)S=Math.max(0,A[fe].g-100),J=!1;else try{hg(ye,k,"req"+Y+"_")}catch{f&&f(ye)}}if(J){f=k.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function Gl(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;Qn||tl(),Yn||(Qn(),Yn=!0),Gs.add(c,s),s.v=0}}function mo(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=nr(w(s.Fa,s),Ql(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,Hl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=nr(w(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Te(10),pi(this),Hl(this))};function go(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function Hl(s){s.g=new Tt(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=rt(s.qa);Z(c,"RID","rpc"),Z(c,"SID",s.K),Z(c,"AID",s.T),Z(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&Z(c,"TO",s.ja),Z(c,"TYPE","xmlhttp"),dr(s,c),s.m&&s.o&&fo(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=hi(rt(c)),l.m=null,l.P=!0,Il(l,s)}n.Za=function(){this.C!=null&&(this.C=null,pi(this),mo(this),Te(19))};function gi(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function Kl(s,c){var l=null;if(s.g==c){gi(s),go(s),s.g=null;var f=2}else if(lo(s.h,c))l=c.D,Sl(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var A=s.B;f=si(),we(f,new gl(f,l)),mi(s)}else Gl(s);else if(A=c.s,A==3||A==0&&0<c.X||!(f==1&&mg(s,c)||f==2&&mo(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),A){case 1:jt(s,5);break;case 4:jt(s,10);break;case 3:jt(s,6);break;default:jt(s,2)}}}function Ql(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function jt(s,c){if(s.j.info("Error code "+c),c==2){var l=w(s.fb,s),f=s.Xa;let A=!f;f=new $t(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||ui(f,"https"),hi(f),A?cg(f.toString(),l):ug(f.toString(),l)}else Te(2);s.G=0,s.l&&s.l.sa(c),Yl(s),jl(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),Te(2)):(this.j.info("Failed to ping google.com"),Te(1))};function Yl(s){if(s.G=0,s.ka=[],s.l){let c=Rl(s.h);(c.length!=0||s.i.length!=0)&&(C(s.ka,c),C(s.ka,s.i),s.h.i.length=0,x(s.i),s.i.length=0),s.l.ra()}}function Jl(s,c,l){var f=l instanceof $t?rt(l):new $t(l);if(f.g!="")c&&(f.g=c+"."+f.g),li(f,f.s);else{var A=u.location;f=A.protocol,c=c?c+"."+A.hostname:A.hostname,A=+A.port;var S=new $t(null);f&&ui(S,f),c&&(S.g=c),A&&li(S,A),l&&(S.l=l),f=S}return l=s.D,c=s.ya,l&&c&&Z(f,l,c),Z(f,"VER",s.la),dr(s,f),f}function Xl(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new ne(new cr({eb:l})):new ne(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zl(){}n=Zl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function _i(){}_i.prototype.g=function(s,c){return new Ce(s,c)};function Ce(s,c){_e.call(this),this.g=new $l(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!q(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!q(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new fn(this)}D(Ce,_e),Ce.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ce.prototype.close=function(){po(this.g)},Ce.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=to(s),s=l);c.i.push(new Xm(c.Ya++,s)),c.G==3&&mi(c)},Ce.prototype.N=function(){this.g.l=null,delete this.j,po(this.g),delete this.g,Ce.aa.N.call(this)};function eh(s){ro.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}D(eh,ro);function th(){io.call(this),this.status=1}D(th,io);function fn(s){this.g=s}D(fn,Zl),fn.prototype.ua=function(){we(this.g,"a")},fn.prototype.ta=function(s){we(this.g,new eh(s))},fn.prototype.sa=function(s){we(this.g,new th)},fn.prototype.ra=function(){we(this.g,"b")},_i.prototype.createWebChannel=_i.prototype.g,Ce.prototype.send=Ce.prototype.o,Ce.prototype.open=Ce.prototype.m,Ce.prototype.close=Ce.prototype.close,$a=ft.createWebChannelTransport=function(){return new _i},qa=ft.getStatEventTarget=function(){return si()},Ba=ft.Event=Bt,ts=ft.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},oi.NO_ERROR=0,oi.TIMEOUT=8,oi.HTTP_ERROR=6,Cr=ft.ErrorCode=oi,_l.COMPLETE="complete",Ua=ft.EventType=_l,dl.EventType=er,er.OPEN="a",er.CLOSE="b",er.ERROR="c",er.MESSAGE="d",_e.prototype.listen=_e.prototype.K,In=ft.WebChannel=dl,UI=ft.FetchXmlHttpFactory=cr,ne.prototype.listenOnce=ne.prototype.L,ne.prototype.getLastError=ne.prototype.Ka,ne.prototype.getLastErrorCode=ne.prototype.Ba,ne.prototype.getStatus=ne.prototype.Z,ne.prototype.getResponseJson=ne.prototype.Oa,ne.prototype.getResponseText=ne.prototype.oa,ne.prototype.send=ne.prototype.ea,ne.prototype.setWithCredentials=ne.prototype.Ha,Fa=ft.XhrIo=ne}).apply(typeof es<"u"?es:typeof self<"u"?self:typeof window<"u"?window:{});var rf="@firebase/firestore",sf="4.7.14";var he=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};he.UNAUTHENTICATED=new he(null),he.GOOGLE_CREDENTIALS=new he("google-credentials-uid"),he.FIRST_PARTY=new he("first-party-uid"),he.MOCK_USER=new he("mock-user");var $n="11.7.3";var cn=new We("@firebase/firestore");function En(){return cn.logLevel}function O(n,...e){if(cn.logLevel<=W.DEBUG){let t=e.map(Su);cn.debug(`Firestore (${$n}): ${n}`,...t)}}function gt(n,...e){if(cn.logLevel<=W.ERROR){let t=e.map(Su);cn.error(`Firestore (${$n}): ${n}`,...t)}}function Cn(n,...e){if(cn.logLevel<=W.WARN){let t=e.map(Su);cn.warn(`Firestore (${$n}): ${n}`,...t)}}function Su(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function F(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Yf(n,r,t)}function Yf(n,e,t){let r=`FIRESTORE (${$n}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw gt(r),new Error(r)}function te(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Yf(e,i,r)}function H(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},V=class extends Ae{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Lt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var cs=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Ka=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(he.UNAUTHENTICATED))}shutdown(){}},Qa=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Ya=class{constructor(e){this.t=e,this.currentUser=he.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){te(this.o===void 0,42304);let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new Lt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Lt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>y(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Lt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string",31837,{l:r}),new cs(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string",2055,{h:e}),new he(e)}},Ja=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=he.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Xa=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Ja(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(he.FIRST_PARTY))}shutdown(){}invalidateToken(){}},us=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Za=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Pe(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){te(this.o===void 0,3512);let r=o=>{o.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.m;return this.m=o.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new us(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(te(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new us(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function BI(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function Jf(){return new TextEncoder}var ls=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=BI(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function z(n,e){return n<e?-1:n>e?1:0}function ec(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return z(r,i);{let o=Jf(),a=qI(o.encode(of(n,t)),o.encode(of(e,t)));return a!==0?a:z(r,i)}}t+=r>65535?2:1}return z(n.length,e.length)}function of(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function qI(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return z(n[t],e[t]);return z(n.length,e.length)}function kn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var af=-62135596800,cf=1e6,Ve=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*cf);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<af)throw new V(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cf}_compareTo(e){return this.seconds===e.seconds?z(this.nanoseconds,e.nanoseconds):z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-af;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var B=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ve(0,0))}static max(){return new n(new Ve(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var uf="__name__",hs=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&F(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&F(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return z(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):ec(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return dt.fromString(e.substring(4,e.length-2))}},ce=class n extends hs{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new V(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},$I=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Be=class n extends hs{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return $I.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===uf}static keyField(){return new n([uf])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new V(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new V(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new V(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new V(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(ce.fromString(e))}static fromName(e){return new n(ce.fromString(e).popFirst(5))}static empty(){return new n(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ce(e.slice()))}};var Lr=-1,tc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};tc.UNKNOWN_ID=-1;function jI(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=B.fromTimestamp(r===1e9?new Ve(t+1,0):new Ve(t,r));return new un(i,L.empty(),e)}function zI(n){return new un(n.readTime,n.key,Lr)}var un=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(B.min(),L.empty(),Lr)}static max(){return new n(B.max(),L.empty(),Lr)}};function WI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:z(n.largestBatchId,e.largestBatchId))}var GI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",nc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Us(n){return y(this,null,function*(){if(n.code!==N.FAILED_PRECONDITION||n.message!==GI)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&F(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function HI(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function jn(n){return n.name==="IndexedDbTransactionError"}var Ru=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>r.writeSequenceNumber(i))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ce&&this.ce(t),t}}n.le=-1;return n})(),KI=-1;function Bs(n){return n==null}function ds(n){return n===0&&1/n==-1/0}var Xf="";function QI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=lf(e)),e=YI(n.get(t),e);return lf(e)}function YI(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case Xf:t+="";break;default:t+=o}}return t}function lf(n){return n+Xf+""}var JI="remoteDocuments",Zf="owner";var ep="mutationQueues";var tp="mutations";var np="documentMutations",XI="remoteDocumentsV14";var rp="remoteDocumentGlobal";var ip="targets";var sp="targetDocuments";var op="targetGlobal",ap="collectionParents";var cp="clientMetadata";var up="bundles";var lp="namedQueries";var ZI="indexConfiguration";var eE="indexState";var tE="indexEntries";var hp="documentOverlays";var nE="globals";var rE=[ep,tp,np,JI,ip,Zf,op,sp,cp,rp,ap,up,lp],l0=[...rE,hp],iE=[ep,tp,np,XI,ip,Zf,op,sp,cp,rp,ap,up,lp,hp],sE=iE,oE=[...sE,ZI,eE,tE];var h0=[...oE,nE];function hf(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Jr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function aE(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ie=class n{constructor(e,t){this.comparator=e,this.root=t||Je.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Je.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Je.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bn(this.root,e,this.comparator,!1)}getReverseIterator(){return new bn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bn(this.root,e,this.comparator,!0)}},bn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Je=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw F(43730,{key:this.key,value:this.value});if(this.right.isRed())throw F(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw F(27949);return e+(this.isRed()?0:1)}};Je.EMPTY=null,Je.RED=!0,Je.BLACK=!1;Je.EMPTY=new class{constructor(){this.size=0}get key(){throw F(57766)}get value(){throw F(16141)}get color(){throw F(16727)}get left(){throw F(29726)}get right(){throw F(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Je(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var de=class n{constructor(e){this.comparator=e,this.data=new ie(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fs(this.data.getIterator())}getIteratorFrom(e){return new fs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},fs=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var rn=class n{constructor(e){this.fields=e,e.sort(Be.comparator)}static empty(){return new n([])}unionWith(e){let t=new de(Be.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return kn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var ps=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ee=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new ps("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ee.EMPTY_BYTE_STRING=new Ee("");var cE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _t(n){if(te(!!n,39018),typeof n=="string"){let e=0,t=cE.exec(n);if(te(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ee(n.seconds),nanos:ee(n.nanos)}}function ee(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function yt(n){return typeof n=="string"?Ee.fromBase64String(n):Ee.fromUint8Array(n)}var dp="server_timestamp",fp="__type__",pp="__previous_value__",mp="__local_write_time__";function Pu(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[fp])===null||t===void 0?void 0:t.stringValue)===dp}function qs(n){let e=n.mapValue.fields[pp];return Pu(e)?qs(e):e}function Mr(n){let e=_t(n.mapValue.fields[mp].timestampValue);return new Ve(e.seconds,e.nanos)}var rc=class{constructor(e,t,r,i,o,a,u,h,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}},ms="(default)",gs=class n{constructor(e,t){this.projectId=e,this.database=t||ms}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===ms}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var gp="__type__",_p="__max__",ns={mapValue:{fields:{__type__:{stringValue:_p}}}},yp="__vector__",Fr="value";function Mt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Pu(n)?4:Ip(n)?9007199254740991:vp(n)?10:11:F(28295,{value:n})}function Ze(n,e){if(n===e)return!0;let t=Mt(n);if(t!==Mt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Mr(n).isEqual(Mr(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=_t(i.timestampValue),u=_t(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return yt(i.bytesValue).isEqual(yt(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return ee(i.geoPointValue.latitude)===ee(o.geoPointValue.latitude)&&ee(i.geoPointValue.longitude)===ee(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return ee(i.integerValue)===ee(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=ee(i.doubleValue),u=ee(o.doubleValue);return a===u?ds(a)===ds(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return kn(n.arrayValue.values||[],e.arrayValue.values||[],Ze);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(hf(a)!==hf(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!Ze(a[h],u[h])))return!1;return!0}(n,e);default:return F(52216,{left:n})}}function Ur(n,e){return(n.values||[]).find(t=>Ze(t,e))!==void 0}function Dn(n,e){if(n===e)return 0;let t=Mt(n),r=Mt(e);if(t!==r)return z(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return z(n.booleanValue,e.booleanValue);case 2:return function(o,a){let u=ee(o.integerValue||o.doubleValue),h=ee(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return df(n.timestampValue,e.timestampValue);case 4:return df(Mr(n),Mr(e));case 5:return ec(n.stringValue,e.stringValue);case 6:return function(o,a){let u=yt(o),h=yt(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=z(u[d],h[d]);if(p!==0)return p}return z(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let u=z(ee(o.latitude),ee(a.latitude));return u!==0?u:z(ee(o.longitude),ee(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return ff(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,h,d,p;let v=o.fields||{},w=a.fields||{},R=(u=v[Fr])===null||u===void 0?void 0:u.arrayValue,D=(h=w[Fr])===null||h===void 0?void 0:h.arrayValue,x=z(((d=R?.values)===null||d===void 0?void 0:d.length)||0,((p=D?.values)===null||p===void 0?void 0:p.length)||0);return x!==0?x:ff(R,D)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===ns.mapValue&&a===ns.mapValue)return 0;if(o===ns.mapValue)return 1;if(a===ns.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let v=0;v<h.length&&v<p.length;++v){let w=ec(h[v],p[v]);if(w!==0)return w;let R=Dn(u[h[v]],d[p[v]]);if(R!==0)return R}return z(h.length,p.length)}(n.mapValue,e.mapValue);default:throw F(23264,{Pe:t})}}function df(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return z(n,e);let t=_t(n),r=_t(e),i=z(t.seconds,r.seconds);return i!==0?i:z(t.nanos,r.nanos)}function ff(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Dn(t[i],r[i]);if(o)return o}return z(t.length,r.length)}function Nn(n){return ic(n)}function ic(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=_t(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return yt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return L.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=ic(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${ic(t.fields[a])}`;return i+"}"}(n.mapValue):F(61005,{value:n})}function ss(n){switch(Mt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=qs(n);return e?16+ss(e):16;case 5:return 2*n.stringValue.length;case 6:return yt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+ss(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Jr(r.fields,(o,a)=>{i+=o.length+ss(a)}),i}(n.mapValue);default:throw F(13486,{value:n})}}function sc(n){return!!n&&"integerValue"in n}function Cu(n){return!!n&&"arrayValue"in n}function pf(n){return!!n&&"nullValue"in n}function mf(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ja(n){return!!n&&"mapValue"in n}function vp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[gp])===null||t===void 0?void 0:t.stringValue)===yp}function Dr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Jr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Dr(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Ip(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===_p}var f0={mapValue:{fields:{[gp]:{stringValue:yp},[Fr]:{arrayValue:{}}}}};var pt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ja(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dr(t)}setAll(e){let t=Be.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=Dr(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());ja(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ze(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ja(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Jr(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Dr(this.value))}};var qe=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,B.min(),B.min(),B.min(),pt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,B.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,B.min(),B.min(),pt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,B.min(),B.min(),pt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var On=class{constructor(e,t){this.position=e,this.inclusive=t}};function gf(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),t.key):r=Dn(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function _f(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ze(n.position[t],e.position[t]))return!1;return!0}var xn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function uE(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var _s=class{},ue=class n extends _s{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new ac(e,t,r):t==="array-contains"?new lc(e,r):t==="in"?new hc(e,r):t==="not-in"?new dc(e,r):t==="array-contains-any"?new fc(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new cc(e,r):new uc(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Dn(t,this.value)):t!==null&&Mt(this.value)===Mt(t)&&this.matchesComparison(Dn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return F(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},et=class n extends _s{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new n(e,t)}matches(e){return Ep(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}};function Ep(n){return n.op==="and"}function wp(n){return lE(n)&&Ep(n)}function lE(n){for(let e of n.filters)if(e instanceof et)return!1;return!0}function oc(n){if(n instanceof ue)return n.field.canonicalString()+n.op.toString()+Nn(n.value);if(wp(n))return n.filters.map(e=>oc(e)).join(",");{let e=n.filters.map(t=>oc(t)).join(",");return`${n.op}(${e})`}}function Tp(n,e){return n instanceof ue?function(r,i){return i instanceof ue&&r.op===i.op&&r.field.isEqual(i.field)&&Ze(r.value,i.value)}(n,e):n instanceof et?function(r,i){return i instanceof et&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&Tp(a,i.filters[u]),!0):!1}(n,e):void F(19439)}function Ap(n){return n instanceof ue?function(t){return`${t.field.canonicalString()} ${t.op} ${Nn(t.value)}`}(n):n instanceof et?function(t){return t.op.toString()+" {"+t.getFilters().map(Ap).join(" ,")+"}"}(n):"Filter"}var ac=class extends ue{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},cc=class extends ue{constructor(e,t){super(e,"in",t),this.keys=bp("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},uc=class extends ue{constructor(e,t){super(e,"not-in",t),this.keys=bp("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function bp(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var lc=class extends ue{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Cu(t)&&Ur(t.arrayValue,this.value)}},hc=class extends ue{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ur(this.value.arrayValue,t)}},dc=class extends ue{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ur(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ur(this.value.arrayValue,t)}},fc=class extends ue{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Cu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ur(this.value.arrayValue,r))}};var pc=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.Ie=null}};function yf(n,e=null,t=[],r=[],i=null,o=null,a=null){return new pc(n,e,t,r,i,o,a)}function ku(n){let e=H(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>oc(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Bs(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Nn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Nn(r)).join(",")),e.Ie=t}return e.Ie}function Du(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!uE(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Tp(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!_f(n.startAt,e.startAt)&&_f(n.endAt,e.endAt)}function mc(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Vn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}};function hE(n,e,t,r,i,o,a,u){return new Vn(n,e,t,r,i,o,a,u)}function Nu(n){return new Vn(n)}function vf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function dE(n){return n.collectionGroup!==null}function Nr(n){let e=H(n);if(e.Ee===null){e.Ee=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ee.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new de(Be.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ee.push(new xn(o,r))}),t.has(Be.keyField().canonicalString())||e.Ee.push(new xn(Be.keyField(),r))}return e.Ee}function Xe(n){let e=H(n);return e.de||(e.de=fE(e,Nr(n))),e.de}function fE(n,e){if(n.limitType==="F")return yf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new xn(i.field,o)});let t=n.endAt?new On(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new On(n.startAt.position,n.startAt.inclusive):null;return yf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function gc(n,e,t){return new Vn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function $s(n,e){return Du(Xe(n),Xe(e))&&n.limitType===e.limitType}function Sp(n){return`${ku(Xe(n))}|lt:${n.limitType}`}function wn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Ap(i)).join(", ")}]`),Bs(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Nn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Nn(i)).join(",")),`Target(${r})`}(Xe(n))}; limitType=${n.limitType})`}function js(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):L.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of Nr(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=gf(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,Nr(r),i)||r.endAt&&!function(a,u,h){let d=gf(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,Nr(r),i))}(n,e)}function pE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Rp(n){return(e,t)=>{let r=!1;for(let i of Nr(n)){let o=mE(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function mE(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Dn(h,d):F(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return F(19790,{direction:n.dir})}}var vt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Jr(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return aE(this.inner)}size(){return this.innerSize}};var gE=new ie(L.comparator);function Ft(){return gE}var Pp=new ie(L.comparator);function kr(...n){let e=Pp;for(let t of n)e=e.insert(t.key,t);return e}function _E(n){let e=Pp;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function sn(){return Or()}function Cp(){return Or()}function Or(){return new vt(n=>n.toString(),(n,e)=>n.isEqual(e))}var p0=new ie(L.comparator),yE=new de(L.comparator);function Q(...n){let e=yE;for(let t of n)e=e.add(t);return e}var vE=new de(z);function IE(){return vE}function EE(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ds(e)?"-0":e}}function wE(n){return{integerValue:""+n}}var Ln=class{constructor(){this._=void 0}};function TE(n,e,t){return n instanceof Br?function(i,o){let a={fields:{[fp]:{stringValue:dp},[mp]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Pu(o)&&(o=qs(o)),o&&(a.fields[pp]=o),{mapValue:a}}(t,e):n instanceof Mn?kp(n,e):n instanceof Fn?Dp(n,e):function(i,o){let a=bE(i,o),u=If(a)+If(i.Re);return sc(a)&&sc(i.Re)?wE(u):EE(i.serializer,u)}(n,e)}function AE(n,e,t){return n instanceof Mn?kp(n,e):n instanceof Fn?Dp(n,e):t}function bE(n,e){return n instanceof qr?function(r){return sc(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Br=class extends Ln{},Mn=class extends Ln{constructor(e){super(),this.elements=e}};function kp(n,e){let t=Np(e);for(let r of n.elements)t.some(i=>Ze(i,r))||t.push(r);return{arrayValue:{values:t}}}var Fn=class extends Ln{constructor(e){super(),this.elements=e}};function Dp(n,e){let t=Np(e);for(let r of n.elements)t=t.filter(i=>!Ze(i,r));return{arrayValue:{values:t}}}var qr=class extends Ln{constructor(e,t){super(),this.serializer=e,this.Re=t}};function If(n){return ee(n.integerValue||n.doubleValue)}function Np(n){return Cu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function SE(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Mn&&i instanceof Mn||r instanceof Fn&&i instanceof Fn?kn(r.elements,i.elements,Ze):r instanceof qr&&i instanceof qr?Ze(r.Re,i.Re):r instanceof Br&&i instanceof Br}(n.transform,e.transform)}var xr=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function os(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var $r=class{};function Op(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _c(n.key,xr.none()):new jr(n.key,n.data,xr.none());{let t=n.data,r=pt.empty(),i=new de(Be.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new Un(n.key,r,new rn(i.toArray()),xr.none())}}function RE(n,e,t){n instanceof jr?function(i,o,a){let u=i.value.clone(),h=wf(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Un?function(i,o,a){if(!os(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=wf(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(xp(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Vr(n,e,t,r){return n instanceof jr?function(o,a,u,h){if(!os(o.precondition,a))return u;let d=o.value.clone(),p=Tf(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Un?function(o,a,u,h){if(!os(o.precondition,a))return u;let d=Tf(o.fieldTransforms,h,a),p=a.data;return p.setAll(xp(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))}(n,e,t,r):function(o,a,u){return os(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function Ef(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&kn(r,i,(o,a)=>SE(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var jr=class extends $r{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Un=class extends $r{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function xp(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function wf(n,e,t){let r=new Map;te(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,AE(a,u,t[i]))}return r}function Tf(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,TE(o,a,e))}return r}var _c=class extends $r{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};var yc=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&RE(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Vr(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Vr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Cp();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=Op(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(B.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Q())}isEqual(e){return this.batchId===e.batchId&&kn(this.mutations,e.mutations,(t,r)=>Ef(t,r))&&kn(this.baseMutations,e.baseMutations,(t,r)=>Ef(t,r))}};var vc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Ic=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var oe,G;function Vp(n){if(n===void 0)return gt("GRPC error has no .code"),N.UNKNOWN;switch(n){case oe.OK:return N.OK;case oe.CANCELLED:return N.CANCELLED;case oe.UNKNOWN:return N.UNKNOWN;case oe.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case oe.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case oe.INTERNAL:return N.INTERNAL;case oe.UNAVAILABLE:return N.UNAVAILABLE;case oe.UNAUTHENTICATED:return N.UNAUTHENTICATED;case oe.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case oe.NOT_FOUND:return N.NOT_FOUND;case oe.ALREADY_EXISTS:return N.ALREADY_EXISTS;case oe.PERMISSION_DENIED:return N.PERMISSION_DENIED;case oe.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case oe.ABORTED:return N.ABORTED;case oe.OUT_OF_RANGE:return N.OUT_OF_RANGE;case oe.UNIMPLEMENTED:return N.UNIMPLEMENTED;case oe.DATA_LOSS:return N.DATA_LOSS;default:return F(39323,{code:n})}}(G=oe||(oe={}))[G.OK=0]="OK",G[G.CANCELLED=1]="CANCELLED",G[G.UNKNOWN=2]="UNKNOWN",G[G.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",G[G.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",G[G.NOT_FOUND=5]="NOT_FOUND",G[G.ALREADY_EXISTS=6]="ALREADY_EXISTS",G[G.PERMISSION_DENIED=7]="PERMISSION_DENIED",G[G.UNAUTHENTICATED=16]="UNAUTHENTICATED",G[G.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",G[G.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",G[G.ABORTED=10]="ABORTED",G[G.OUT_OF_RANGE=11]="OUT_OF_RANGE",G[G.UNIMPLEMENTED=12]="UNIMPLEMENTED",G[G.INTERNAL=13]="INTERNAL",G[G.UNAVAILABLE=14]="UNAVAILABLE",G[G.DATA_LOSS=15]="DATA_LOSS";var Af=null;var PE=new dt([4294967295,4294967295],0);function bf(n){let e=Jf().encode(n),t=new Ma;return t.update(e),new Uint8Array(t.digest())}function Sf(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new dt([t,r],0),new dt([i,o],0)]}var Ec=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new on(`Invalid padding: ${t}`);if(r<0)throw new on(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new on(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new on(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=dt.fromNumber(this.pe)}we(e,t,r){let i=e.add(t.multiply(dt.fromNumber(r)));return i.compare(PE)===1&&(i=new dt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;let t=bf(e),[r,i]=Sf(t);for(let o=0;o<this.hashCount;o++){let a=this.we(r,i,o);if(!this.be(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.pe===0)return;let t=bf(e),[r,i]=Sf(t);for(let o=0;o<this.hashCount;o++){let a=this.we(r,i,o);this.Se(a)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},on=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ys=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,zr.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(B.min(),i,new ie(z),Ft(),Q())}},zr=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Q(),Q(),Q())}};var Sn=class{constructor(e,t,r,i){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=i}},vs=class{constructor(e,t){this.targetId=e,this.Ce=t}},Is=class{constructor(e,t,r=Ee.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Es=class{constructor(){this.Fe=0,this.Me=Rf(),this.xe=Ee.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Q(),t=Q(),r=Q();return this.Me.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:F(38017,{changeType:o})}}),new zr(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=Rf()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,te(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}},wc=class{constructor(e){this.ze=e,this.je=new Map,this.He=Ft(),this.Je=rs(),this.Ye=rs(),this.Ze=new ie(z)}Xe(e){for(let t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(let t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{let r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:F(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,i)=>{this.it(i)&&t(i)})}ot(e){let t=e.targetId,r=e.Ce.count,i=this._t(t);if(i){let o=i.target;if(mc(o))if(r===0){let a=new L(o.path);this.tt(t,a,qe.newNoDocument(a,B.min()))}else te(r===1,20013,{expectedCount:r});else{let a=this.ut(t);if(a!==r){let u=this.ct(e),h=u?this.lt(u,e,a):1;if(h!==0){this.st(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,d)}Af?.ht(function(p,v,w,R,D){var x,C,j,q,U,$;let se={localCacheCount:p,existenceFilterCount:v.count,databaseId:w.database,projectId:w.projectId},K=v.unchangedNames;return K&&(se.bloomFilter={applied:D===0,hashCount:(x=K?.hashCount)!==null&&x!==void 0?x:0,bitmapLength:(q=(j=(C=K?.bits)===null||C===void 0?void 0:C.bitmap)===null||j===void 0?void 0:j.length)!==null&&q!==void 0?q:0,padding:($=(U=K?.bits)===null||U===void 0?void 0:U.padding)!==null&&$!==void 0?$:0,mightContain:E=>{var m;return(m=R?.mightContain(E))!==null&&m!==void 0&&m}}),se}(a,e.Ce,this.ze.Pt(),u,h))}}}}ct(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=yt(r).toUint8Array()}catch(h){if(h instanceof ps)return Cn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Ec(a,i,o)}catch(h){return Cn(h instanceof on?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.pe===0?null:u}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){let r=this.ze.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.ze.Pt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.tt(t,o,null),i++)}),i}It(e){let t=new Map;this.je.forEach((o,a)=>{let u=this._t(a);if(u){if(o.current&&mc(u.target)){let h=new L(u.target.path);this.Et(h).has(a)||this.dt(a,h)||this.tt(a,h,qe.newNoDocument(h,e))}o.Le&&(t.set(a,o.qe()),o.Qe())}});let r=Q();this.Ye.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let d=this._t(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.He.forEach((o,a)=>a.setReadTime(e));let i=new ys(e,t,this.Ze,this.He,r);return this.He=Ft(),this.Je=rs(),this.Ye=rs(),this.Ze=new ie(z),i}et(e,t){if(!this.it(e))return;let r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;let i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){let t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new Es,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new de(z),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new de(z),this.Je=this.Je.insert(e,t)),t}it(e){let t=this._t(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}_t(e){let t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Es),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}};function rs(){return new ie(L.comparator)}function Rf(){return new ie(L.comparator)}var CE={asc:"ASCENDING",desc:"DESCENDING"},kE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},DE={and:"AND",or:"OR"},Tc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Ac(n,e){return n.useProto3Json||Bs(e)?e:{value:e}}function NE(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function OE(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Rn(n){return te(!!n,49232),B.fromTimestamp(function(t){let r=_t(t);return new Ve(r.seconds,r.nanos)}(n))}function xE(n,e){return bc(n,e).canonicalString()}function bc(n,e){let t=function(i){return new ce(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Lp(n){let e=ce.fromString(n);return te(qp(e),10190,{key:e.toString()}),e}function za(n,e){let t=Lp(e);if(t.get(1)!==n.databaseId.projectId)throw new V(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new V(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(Fp(t))}function Mp(n,e){return xE(n.databaseId,e)}function VE(n){let e=Lp(n);return e.length===4?ce.emptyPath():Fp(e)}function Pf(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Fp(n){return te(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function LE(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:F(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(te(p===void 0||typeof p=="string",58123),Ee.fromBase64String(p||"")):(te(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Ee.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?N.UNKNOWN:Vp(d.code);return new V(p,d.message||"")}(a);t=new Is(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=za(n,r.document.name),o=Rn(r.document.updateTime),a=r.document.createTime?Rn(r.document.createTime):B.min(),u=new pt({mapValue:{fields:r.document.fields}}),h=qe.newFoundDocument(i,o,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Sn(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=za(n,r.document),o=r.readTime?Rn(r.readTime):B.min(),a=qe.newNoDocument(i,o),u=r.removedTargetIds||[];t=new Sn([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=za(n,r.document),o=r.removedTargetIds||[];t=new Sn([],o,i,null)}else{if(!("filter"in e))return F(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new Ic(i,o),u=r.targetId;t=new vs(u,a)}}return t}function ME(n,e){return{documents:[Mp(n,e.path)]}}function FE(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Mp(n,i);let o=function(d){if(d.length!==0)return Bp(et.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(p=>function(w){return{field:Tn(w.field),direction:qE(w.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Ac(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{gt:t,parent:i}}function UE(n){let e=VE(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){te(r===1,65062);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(v){let w=Up(v);return w instanceof et&&wp(w)?w.getFilters():[w]}(t.where));let a=[];t.orderBy&&(a=function(v){return v.map(w=>function(D){return new xn(An(D.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(w))}(t.orderBy));let u=null;t.limit&&(u=function(v){let w;return w=typeof v=="object"?v.value:v,Bs(w)?null:w}(t.limit));let h=null;t.startAt&&(h=function(v){let w=!!v.before,R=v.values||[];return new On(R,w)}(t.startAt));let d=null;return t.endAt&&(d=function(v){let w=!v.before,R=v.values||[];return new On(R,w)}(t.endAt)),hE(e,i,a,o,u,"F",h,d)}function BE(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return F(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Up(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=An(t.unaryFilter.field);return ue.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=An(t.unaryFilter.field);return ue.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=An(t.unaryFilter.field);return ue.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=An(t.unaryFilter.field);return ue.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return F(61313);default:return F(60726)}}(n):n.fieldFilter!==void 0?function(t){return ue.create(An(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return F(58110);default:return F(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return et.create(t.compositeFilter.filters.map(r=>Up(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return F(1026)}}(t.compositeFilter.op))}(n):F(30097,{filter:n})}function qE(n){return CE[n]}function $E(n){return kE[n]}function jE(n){return DE[n]}function Tn(n){return{fieldPath:n.canonicalString()}}function An(n){return Be.fromServerFormat(n.fieldPath)}function Bp(n){return n instanceof ue?function(t){if(t.op==="=="){if(mf(t.value))return{unaryFilter:{field:Tn(t.field),op:"IS_NAN"}};if(pf(t.value))return{unaryFilter:{field:Tn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(mf(t.value))return{unaryFilter:{field:Tn(t.field),op:"IS_NOT_NAN"}};if(pf(t.value))return{unaryFilter:{field:Tn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Tn(t.field),op:$E(t.op),value:t.value}}}(n):n instanceof et?function(t){let r=t.getFilters().map(i=>Bp(i));return r.length===1?r[0]:{compositeFilter:{op:jE(t.op),filters:r}}}(n):F(54877,{filter:n})}function qp(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Wr=class n{constructor(e,t,r,i,o=B.min(),a=B.min(),u=Ee.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Sc=class{constructor(e){this.wt=e}};function zE(n){let e=UE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?gc(e,e.limit,"L"):e}var ws=class{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(ee(e.integerValue));else if("doubleValue"in e){let r=ee(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),ds(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=_t(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(yt(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?Ip(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):vp(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):F(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){let r=e.fields||{};this.Mt(t,55);for(let i of Object.keys(r))this.Nt(i,t),this.Ct(r[i],t)}qt(e,t){var r,i;let o=e.fields||{};this.Mt(t,53);let a=Fr,u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(ee(u)),this.Nt(a,t),this.Ct(o[a],t)}$t(e,t){let r=e.values||[];this.Mt(t,50);for(let i of r)this.Ct(i,t)}kt(e,t){this.Mt(t,37),L.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}};ws.Wt=new ws;var Rc=class{constructor(){this.yn=new Pc}addToCollectionParentIndex(e,t){return this.yn.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.yn.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(un.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(un.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Pc=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new de(ce.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new de(ce.comparator)).toArray()}};var m0=new Uint8Array(0);var Cf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$p=41943040,xe=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};xe.DEFAULT_COLLECTION_PERCENTILE=10,xe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xe.DEFAULT=new xe($p,xe.DEFAULT_COLLECTION_PERCENTILE,xe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xe.DISABLED=new xe(-1,0,0);var Gr=class n{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new n(0)}static ir(){return new n(-1)}};var kf="LruGarbageCollector",WE=1048576;function Df([n,e],[t,r]){let i=z(n,t);return i===0?z(e,r):i}var Cc=class{constructor(e){this.cr=e,this.buffer=new de(Df),this.lr=0}hr(){return++this.lr}Pr(e){let t=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Df(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},kc=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Tr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return this.Tr!==null}Ir(e){O(kf,`Garbage collection scheduled in ${e}ms`),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>y(this,null,function*(){this.Tr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){jn(t)?O(kf,"Ignoring IndexedDB error during garbage collection: ",t):yield Us(t)}yield this.Ir(3e5)}))}},Dc=class{constructor(e,t){this.Er=e,this.params=t}calculateTargetCount(e,t){return this.Er.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return P.resolve(Ru.le);let r=new Cc(t);return this.Er.forEachTarget(e,i=>r.Pr(i.sequenceNumber)).next(()=>this.Er.Ar(e,i=>r.Pr(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Er.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Er.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(Cf)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Cf):this.Rr(e,t))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,t){let r,i,o,a,u,h,d,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,a=Date.now(),this.nthSequenceNumber(e,i))).next(v=>(r=v,u=Date.now(),this.removeTargets(e,r,t))).next(v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(v=>(d=Date.now(),En()<=W.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${v} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:v})))}};function GE(n,e){return new Dc(n,e)}var Nc=class{constructor(){this.changes=new vt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,qe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Oc=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var xc=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Vr(r.mutation,i,rn.empty(),Ve.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Q()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Q()){let i=sn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=kr();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=sn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Q()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=Ft(),a=Or(),u=function(){return Or()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Un)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),Vr(p.mutation,d,p.mutation.getFieldMask(),Ve.now())):a.set(d.key,rn.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var v;return u.set(d,new Oc(p,(v=a.get(d))!==null&&v!==void 0?v:null))}),u))}recalculateAndSaveOverlays(e,t){let r=Or(),i=new ie((a,u)=>a-u),o=Q();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||rn.empty();p=u.applyToLocalView(d,p),r.set(h,p);let v=(i.get(u.batchId)||Q()).add(h);i=i.insert(u.batchId,v)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,v=Cp();p.forEach(w=>{if(!o.has(w)){let R=Op(t.get(w),r.get(w));R!==null&&v.set(w,R),o=o.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,v))}return P.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):P.resolve(sn()),u=Lr,h=o;return a.next(d=>P.forEach(d,(p,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(w=>{h=h.insert(p,w)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,Q())).next(p=>({batchId:u,changes:_E(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let i=kr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=kr();return this.indexManager.getCollectionParents(e,o).next(u=>P.forEach(u,h=>{let d=function(v,w){return new Vn(w,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((v,w)=>{a=a.insert(v,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,qe.newInvalidDocument(p)))});let u=kr();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&Vr(p.mutation,d,rn.empty(),Ve.now()),js(t,d)&&(u=u.insert(h,d))}),u})}};var Vc=class{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,t){return P.resolve(this.Fr.get(t))}saveBundleMetadata(e,t){return this.Fr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Rn(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Mr.get(t))}saveNamedQuery(e,t){return this.Mr.set(t.name,function(i){return{name:i.name,query:zE(i.bundledQuery),readTime:Rn(i.readTime)}}(t)),P.resolve()}};var Lc=class{constructor(){this.overlays=new ie(L.comparator),this.Or=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=sn();return P.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.St(e,t,o)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Or.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Or.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=sn(),o=t.length+1,a=new L(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ie((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=sn(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=sn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return P.resolve(u)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Or.get(i.largestBatchId).delete(r.key);this.Or.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new vc(t,r));let o=this.Or.get(t);o===void 0&&(o=Q(),this.Or.set(t,o)),this.Or.set(t,o.add(r.key))}};var Mc=class{constructor(){this.sessionToken=Ee.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var Hr=class{constructor(){this.Nr=new de(ae.Br),this.Lr=new de(ae.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,t){let r=new ae(e,t);this.Nr=this.Nr.add(r),this.Lr=this.Lr.add(r)}qr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Qr(new ae(e,t))}$r(e,t){e.forEach(r=>this.removeReference(r,t))}Ur(e){let t=new L(new ce([])),r=new ae(t,e),i=new ae(t,e+1),o=[];return this.Lr.forEachInRange([r,i],a=>{this.Qr(a),o.push(a.key)}),o}Kr(){this.Nr.forEach(e=>this.Qr(e))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){let t=new L(new ce([])),r=new ae(t,e),i=new ae(t,e+1),o=Q();return this.Lr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new ae(e,0),r=this.Nr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ae=class{constructor(e,t){this.key=e,this.Gr=t}static Br(e,t){return L.comparator(e.key,t.key)||z(e.Gr,t.Gr)}static kr(e,t){return z(e.Gr,t.Gr)||L.comparator(e.key,t.key)}};var Fc=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Jn=1,this.zr=new de(ae.Br)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new yc(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.zr=this.zr.add(new ae(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.jr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Hr(r),o=i<0?0:i;return P.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?KI:this.Jn-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ae(t,0),i=new ae(t,Number.POSITIVE_INFINITY),o=[];return this.zr.forEachInRange([r,i],a=>{let u=this.jr(a.Gr);o.push(u)}),P.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new de(z);return t.forEach(i=>{let o=new ae(i,0),a=new ae(i,Number.POSITIVE_INFINITY);this.zr.forEachInRange([o,a],u=>{r=r.add(u.Gr)})}),P.resolve(this.Jr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;L.isDocumentKey(o)||(o=o.child(""));let a=new ae(new L(o),0),u=new de(z);return this.zr.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.Gr)),!0)},a),P.resolve(this.Jr(u))}Jr(e){let t=[];return e.forEach(r=>{let i=this.jr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){te(this.Yr(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.zr;return P.forEach(t.mutations,i=>{let o=new ae(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.zr=r})}Xn(e){}containsKey(e,t){let r=new ae(t,0),i=this.zr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Yr(e,t){return this.Hr(e)}Hr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}jr(e){let t=this.Hr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Uc=class{constructor(e){this.Zr=e,this.docs=function(){return new ie(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Zr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():qe.newInvalidDocument(t))}getEntries(e,t){let r=Ft();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():qe.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Ft(),a=t.path,u=new L(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||WI(zI(p),r)<=0||(i.has(p.key)||js(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return P.resolve(o)}getAllFromCollectionGroup(e,t,r,i){F(9500)}Xr(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Bc(this)}getSize(e){return P.resolve(this.size)}},Bc=class extends Nc{constructor(e){super(),this.vr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.vr.addEntry(e,i)):this.vr.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.vr.getEntry(e,t)}getAllFromCache(e,t){return this.vr.getEntries(e,t)}};var qc=class{constructor(e){this.persistence=e,this.ei=new vt(t=>ku(t),Du),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.ti=0,this.ni=new Hr,this.targetCount=0,this.ri=Gr.rr()}forEachTarget(e,t){return this.ei.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ti&&(this.ti=t),P.resolve()}ar(e){this.ei.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ri=new Gr(t),this.highestTargetId=t),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,t){return this.ar(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.ar(t),P.resolve()}removeTargetData(e,t){return this.ei.delete(t.target),this.ni.Ur(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ei.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ei.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),P.waitFor(o).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.ei.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.ni.qr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.ni.$r(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),P.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.ni.Ur(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.ni.Wr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.ni.containsKey(t))}};var Ts=class{constructor(e,t){this.ii={},this.overlays={},this.si=new Ru(0),this.oi=!1,this.oi=!0,this._i=new Mc,this.referenceDelegate=e(this),this.ai=new qc(this),this.indexManager=new Rc,this.remoteDocumentCache=function(i){return new Uc(i)}(r=>this.referenceDelegate.ui(r)),this.serializer=new Sc(t),this.ci=new Vc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Lc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ii[e.toKey()];return r||(r=new Fc(t,this.referenceDelegate),this.ii[e.toKey()]=r),r}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new $c(this.si.next());return this.referenceDelegate.li(),r(i).next(o=>this.referenceDelegate.hi(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Pi(e,t){return P.or(Object.values(this.ii).map(r=>()=>r.containsKey(e,t)))}},$c=class extends nc{constructor(e){super(),this.currentSequenceNumber=e}},jc=class n{constructor(e){this.persistence=e,this.Ti=new Hr,this.Ii=null}static Ei(e){return new n(e)}get di(){if(this.Ii)return this.Ii;throw F(60996)}addReference(e,t,r){return this.Ti.addReference(r,t),this.di.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Ti.removeReference(r,t),this.di.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),P.resolve()}removeTarget(e,t){this.Ti.Ur(t.targetId).forEach(i=>this.di.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.di.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}li(){this.Ii=new Set}hi(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.di,r=>{let i=L.fromPath(r);return this.Ai(e,i).next(o=>{o||t.removeEntry(i,B.min())})}).next(()=>(this.Ii=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ai(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}ui(e){return 0}Ai(e,t){return P.or([()=>P.resolve(this.Ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Pi(e,t)])}},As=class n{constructor(e,t){this.persistence=e,this.Ri=new vt(r=>QI(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=GE(this,t)}static Ei(e,t){return new n(e,t)}li(){}hi(e){return P.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Vr(e){let t=0;return this.Ar(e,r=>{t++}).next(()=>t)}Ar(e,t){return P.forEach(this.Ri,(r,i)=>this.gr(e,r,i).next(o=>o?P.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.Xr(e,a=>this.gr(e,a,t).next(u=>{u||(r++,o.removeEntry(a,B.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.Ri.set(t,e.currentSequenceNumber),P.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),P.resolve()}removeReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),P.resolve()}updateLimboDocument(e,t){return this.Ri.set(t,e.currentSequenceNumber),P.resolve()}ui(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ss(e.data.value)),t}gr(e,t,r){return P.or([()=>this.persistence.Pi(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.Ri.get(t);return P.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var zc=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ls=r,this.hs=i}static Ps(e,t){let r=Q(),i=Q();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Wc=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Gc=class{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=function(){return kh()?8:HI(le())>0?6:4}()}initialize(e,t){this.As=e,this.indexManager=t,this.Ts=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Rs(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Vs(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new Wc;return this.fs(e,t,a).next(u=>{if(o.result=u,this.Is)return this.gs(e,t,a,u.size)})}).next(()=>o.result)}gs(e,t,r,i){return r.documentReadCount<this.Es?(En()<=W.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",wn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),P.resolve()):(En()<=W.DEBUG&&O("QueryEngine","Query:",wn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(En()<=W.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",wn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xe(t))):P.resolve())}Rs(e,t){if(vf(t))return P.resolve(null);let r=Xe(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=gc(t,null,"F"),r=Xe(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=Q(...o);return this.As.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ps(t,u);return this.ys(t,d,a,h.readTime)?this.Rs(e,gc(t,null,"F")):this.ws(e,d,t,h)}))})))}Vs(e,t,r,i){return vf(t)||i.isEqual(B.min())?P.resolve(null):this.As.getDocuments(e,r).next(o=>{let a=this.ps(t,o);return this.ys(t,a,r,i)?P.resolve(null):(En()<=W.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wn(t)),this.ws(e,a,t,jI(i,Lr)).next(u=>u))})}ps(e,t){let r=new de(Rp(e));return t.forEach((i,o)=>{js(e,o)&&(r=r.add(o))}),r}ys(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}fs(e,t,r){return En()<=W.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",wn(t)),this.As.getDocumentsMatchingQuery(e,t,un.min(),r)}ws(e,t,r,i){return this.As.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var Ou="LocalStore",HE=3e8,Hc=class{constructor(e,t,r,i){this.persistence=e,this.bs=t,this.serializer=i,this.Ss=new ie(z),this.Ds=new vt(o=>ku(o),Du),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(r)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xc(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ss))}};function KE(n,e,t,r){return new Hc(n,e,t,r)}function jp(n,e){return y(this,null,function*(){let t=H(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Fs(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=Q();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({Ms:d,removedBatchIds:a,addedBatchIds:u}))})})})}function zp(n){let e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ai.getLastRemoteSnapshotVersion(t))}function QE(n,e){let t=H(n),r=e.snapshotVersion,i=t.Ss;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.Cs.newChangeBuffer({trackRemovals:!0});i=t.Ss;let u=[];e.targetChanges.forEach((p,v)=>{let w=i.get(v);if(!w)return;u.push(t.ai.removeMatchingKeys(o,p.removedDocuments,v).next(()=>t.ai.addMatchingKeys(o,p.addedDocuments,v)));let R=w.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?R=R.withResumeToken(Ee.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):p.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(p.resumeToken,r)),i=i.insert(v,R),function(x,C,j){return x.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=HE?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0}(w,R,p)&&u.push(t.ai.updateTargetData(o,R))});let h=Ft(),d=Q();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(YE(o,a,e.documentUpdates).next(p=>{h=p.xs,d=p.Os})),!r.isEqual(B.min())){let p=t.ai.getLastRemoteSnapshotVersion(o).next(v=>t.ai.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(p)}return P.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.Ss=i,o))}function YE(n,e,t){let r=Q(),i=Q();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=Ft();return t.forEach((u,h)=>{let d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(B.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):O(Ou,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{xs:a,Os:i}})}function JE(n,e){let t=H(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.ai.getTargetData(r,e).next(o=>o?(i=o,P.resolve(i)):t.ai.allocateTargetId(r).next(a=>(i=new Wr(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.ai.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ss.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ss=t.Ss.insert(r.targetId,r),t.Ds.set(e,r.targetId)),r})}function Kc(n,e,t){return y(this,null,function*(){let r=H(n),i=r.Ss.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!jn(a))throw a;O(Ou,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ss=r.Ss.remove(e),r.Ds.delete(i.target)})}function Nf(n,e,t){let r=H(n),i=B.min(),o=Q();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let v=H(h),w=v.Ds.get(p);return w!==void 0?P.resolve(v.Ss.get(w)):v.ai.getTargetData(d,p)}(r,a,Xe(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.ai.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.bs.getDocumentsMatchingQuery(a,e,t?i:B.min(),t?o:Q())).next(u=>(XE(r,pE(e),u),{documents:u,Ns:o})))}function XE(n,e,t){let r=n.vs.get(e)||B.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.vs.set(e,r)}var bs=class{constructor(){this.activeTargetIds=IE()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Qc=class{constructor(){this.So=new bs,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,t,r){this.Do[e]=t}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new bs,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Yc=class{vo(e){}shutdown(){}};var Of="ConnectivityMonitor",Ss=class{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){O(Of,"Network connectivity changed: AVAILABLE");for(let e of this.Oo)e(0)}xo(){O(Of,"Network connectivity changed: UNAVAILABLE");for(let e of this.Oo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var is=null;function Jc(){return is===null?is=function(){return 268435456+Math.round(2147483648*Math.random())}():is++,"0x"+is.toString(16)}var Wa="RestConnection",ZE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Xc=class{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Lo=t+"://"+e.host,this.ko=`projects/${r}/databases/${i}`,this.qo=this.databaseId.database===ms?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Qo(e,t,r,i,o){let a=Jc(),u=this.$o(e,t.toUriEncodedString());O(Wa,`Sending RPC '${e}' ${a}:`,u,r);let h={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};this.Uo(h,i,o);let{host:d}=new URL(u),p=st(d);return this.Ko(e,u,h,r,p).then(v=>(O(Wa,`Received RPC '${e}' ${a}: `,v),v),v=>{throw Cn(Wa,`RPC '${e}' ${a} failed with error: `,v,"url: ",u,"request:",r),v})}Wo(e,t,r,i,o,a){return this.Qo(e,t,r,i,o)}Uo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$n}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}$o(e,t){let r=ZE[e];return`${this.Lo}/v1/${t}:${r}`}terminate(){}};var Zc=class{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}};var Ie="WebChannelConnection",eu=class extends Xc{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,t,r,i,o){let a=Jc();return new Promise((u,h)=>{let d=new Fa;d.setWithCredentials(!0),d.listenOnce(Ua.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Cr.NO_ERROR:let v=d.getResponseJson();O(Ie,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(v)),u(v);break;case Cr.TIMEOUT:O(Ie,`RPC '${e}' ${a} timed out`),h(new V(N.DEADLINE_EXCEEDED,"Request time out"));break;case Cr.HTTP_ERROR:let w=d.getStatus();if(O(Ie,`RPC '${e}' ${a} failed with status:`,w,"response text:",d.getResponseText()),w>0){let R=d.getResponseJson();Array.isArray(R)&&(R=R[0]);let D=R?.error;if(D&&D.status&&D.message){let x=function(j){let q=j.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(q)>=0?q:N.UNKNOWN}(D.status);h(new V(x,D.message))}else h(new V(N.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new V(N.UNAVAILABLE,"Connection failed."));break;default:F(9055,{s_:e,streamId:a,o_:d.getLastErrorCode(),__:d.getLastError()})}}finally{O(Ie,`RPC '${e}' ${a} completed.`)}});let p=JSON.stringify(i);O(Ie,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",p,r,15)})}a_(e,t,r){let i=Jc(),o=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=$a(),u=qa(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Uo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");O(Ie,`Creating RPC '${e}' stream ${i}: ${p}`,h);let v=a.createWebChannel(p,h),w=!1,R=!1,D=new Zc({Go:C=>{R?O(Ie,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(w||(O(Ie,`Opening RPC '${e}' stream ${i} transport.`),v.open(),w=!0),O(Ie,`RPC '${e}' stream ${i} sending:`,C),v.send(C))},zo:()=>v.close()}),x=(C,j,q)=>{C.listen(j,U=>{try{q(U)}catch($){setTimeout(()=>{throw $},0)}})};return x(v,In.EventType.OPEN,()=>{R||(O(Ie,`RPC '${e}' stream ${i} transport opened.`),D.t_())}),x(v,In.EventType.CLOSE,()=>{R||(R=!0,O(Ie,`RPC '${e}' stream ${i} transport closed`),D.r_())}),x(v,In.EventType.ERROR,C=>{R||(R=!0,Cn(Ie,`RPC '${e}' stream ${i} transport errored. Name:`,C.name,"Message:",C.message),D.r_(new V(N.UNAVAILABLE,"The operation could not be completed")))}),x(v,In.EventType.MESSAGE,C=>{var j;if(!R){let q=C.data[0];te(!!q,16349);let U=q,$=U?.error||((j=U[0])===null||j===void 0?void 0:j.error);if($){O(Ie,`RPC '${e}' stream ${i} received error:`,$);let se=$.status,K=function(_){let I=oe[_];if(I!==void 0)return Vp(I)}(se),E=$.message;K===void 0&&(K=N.INTERNAL,E="Unknown error status: "+se+" with message "+$.message),R=!0,D.r_(new V(K,E)),v.close()}else O(Ie,`RPC '${e}' stream ${i} received:`,q),D.i_(q)}}),x(u,Ba.STAT_EVENT,C=>{C.stat===ts.PROXY?O(Ie,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===ts.NOPROXY&&O(Ie,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{D.n_()},0),D}};function Ga(){return typeof document<"u"?document:null}function Wp(n){return new Tc(n,!0)}var Rs=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.bi=e,this.timerId=t,this.u_=r,this.c_=i,this.l_=o,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();let t=Math.floor(this.h_+this.d_()),r=Math.max(0,Date.now()-this.T_),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.h_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.P_=this.bi.enqueueAfterDelay(this.timerId,i,()=>(this.T_=Date.now(),e())),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){this.P_!==null&&(this.P_.skipDelay(),this.P_=null)}cancel(){this.P_!==null&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}};var xf="PersistentStream",tu=class{constructor(e,t,r,i,o,a,u,h){this.bi=e,this.R_=r,this.V_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new Rs(e,t)}w_(){return this.state===1||this.state===5||this.b_()}b_(){return this.state===2||this.state===3}start(){this.p_=0,this.state!==4?this.auth():this.S_()}stop(){return y(this,null,function*(){this.w_()&&(yield this.close(0))})}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&this.f_===null&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,()=>this.C_()))}F_(e){this.M_(),this.stream.send(e)}C_(){return y(this,null,function*(){if(this.b_())return this.close(0)})}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}close(e,t){return y(this,null,function*(){this.M_(),this.x_(),this.y_.cancel(),this.m_++,e!==4?this.y_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(gt(t.toString()),gt("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Zo(t)})}O_(){}auth(){this.state=1;let e=this.N_(this.m_),t=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.m_===t&&this.B_(r,i)},r=>{e(()=>{let i=new V(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.L_(i)})})}B_(e,t){let r=this.N_(this.m_);this.stream=this.k_(e,t),this.stream.jo(()=>{r(()=>this.listener.jo())}),this.stream.Jo(()=>{r(()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,()=>(this.b_()&&(this.state=3),Promise.resolve())),this.listener.Jo()))}),this.stream.Zo(i=>{r(()=>this.L_(i))}),this.stream.onMessage(i=>{r(()=>++this.p_==1?this.q_(i):this.onNext(i))})}S_(){this.state=5,this.y_.E_(()=>y(this,null,function*(){this.state=0,this.start()}))}L_(e){return O(xf,`close with error: ${e}`),this.stream=null,this.close(4,e)}N_(e){return t=>{this.bi.enqueueAndForget(()=>this.m_===e?t():(O(xf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},nu=class extends tu{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}k_(e,t){return this.connection.a_("Listen",e,t)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();let t=LE(this.serializer,e),r=function(o){if(!("targetChange"in o))return B.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?B.min():a.readTime?Rn(a.readTime):B.min()}(e);return this.listener.Q_(t,r)}U_(e){let t={};t.database=Pf(this.serializer),t.addTarget=function(o,a){let u,h=a.target;if(u=mc(h)?{documents:ME(o,h)}:{query:FE(o,h).gt},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=OE(o,a.resumeToken);let d=Ac(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(B.min())>0){u.readTime=NE(o,a.snapshotVersion.toTimestamp());let d=Ac(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=BE(this.serializer,e);r&&(t.labels=r),this.F_(t)}K_(e){let t={};t.database=Pf(this.serializer),t.removeTarget=e,this.F_(t)}};var ru=class{},iu=class extends ru{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.J_=!1}Y_(){if(this.J_)throw new V(N.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,t,r,i){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Qo(e,bc(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new V(N.UNKNOWN,o.toString())})}Wo(e,t,r,i,o){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Wo(e,bc(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new V(N.UNKNOWN,a.toString())})}terminate(){this.J_=!0,this.connection.terminate()}},su=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){this.Z_===0&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve())))}ia(e){this.state==="Online"?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.na("Offline")))}set(e){this.sa(),this.Z_=0,e==="Online"&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ea?(gt(t),this.ea=!1):O("OnlineStateTracker",t)}sa(){this.X_!==null&&(this.X_.cancel(),this.X_=null)}};var Bn="RemoteStore",ou=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=o,this.ca.vo(a=>{r.enqueueAndForget(()=>y(this,null,function*(){Zr(this)&&(O(Bn,"Restarting streams for network reachability change."),yield function(h){return y(this,null,function*(){let d=H(h);d.aa.add(4),yield Xr(d),d.la.set("Unknown"),d.aa.delete(4),yield zs(d)})}(this))}))}),this.la=new su(r,i)}};function zs(n){return y(this,null,function*(){if(Zr(n))for(let e of n.ua)yield e(!0)})}function Xr(n){return y(this,null,function*(){for(let e of n.ua)yield e(!1)})}function Gp(n,e){let t=H(n);t._a.has(e.targetId)||(t._a.set(e.targetId,e),Mu(t)?Lu(t):zn(t).b_()&&Vu(t,e))}function xu(n,e){let t=H(n),r=zn(t);t._a.delete(e),r.b_()&&Hp(t,e),t._a.size===0&&(r.b_()?r.v_():Zr(t)&&t.la.set("Unknown"))}function Vu(n,e){if(n.ha.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}zn(n).U_(e)}function Hp(n,e){n.ha.Ke(e),zn(n).K_(e)}function Lu(n){n.ha=new wc({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n._a.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),zn(n).start(),n.la.ta()}function Mu(n){return Zr(n)&&!zn(n).w_()&&n._a.size>0}function Zr(n){return H(n).aa.size===0}function Kp(n){n.ha=void 0}function ew(n){return y(this,null,function*(){n.la.set("Online")})}function tw(n){return y(this,null,function*(){n._a.forEach((e,t)=>{Vu(n,e)})})}function nw(n,e){return y(this,null,function*(){Kp(n),Mu(n)?(n.la.ia(e),Lu(n)):n.la.set("Unknown")})}function rw(n,e,t){return y(this,null,function*(){if(n.la.set("Online"),e instanceof Is&&e.state===2&&e.cause)try{yield function(i,o){return y(this,null,function*(){let a=o.cause;for(let u of o.targetIds)i._a.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i._a.delete(u),i.ha.removeTarget(u))})}(n,e)}catch(r){O(Bn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Vf(n,r)}else if(e instanceof Sn?n.ha.Xe(e):e instanceof vs?n.ha.ot(e):n.ha.nt(e),!t.isEqual(B.min()))try{let r=yield zp(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let u=o.ha.It(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o._a.get(d);p&&o._a.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=o._a.get(h);if(!p)return;o._a.set(h,p.withResumeToken(Ee.EMPTY_BYTE_STRING,p.snapshotVersion)),Hp(o,h);let v=new Wr(p.target,h,d,p.sequenceNumber);Vu(o,v)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){O(Bn,"Failed to raise snapshot:",r),yield Vf(n,r)}})}function Vf(n,e,t){return y(this,null,function*(){if(!jn(e))throw e;n.aa.add(1),yield Xr(n),n.la.set("Offline"),t||(t=()=>zp(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(null,null,function*(){O(Bn,"Retrying IndexedDB access"),yield t(),n.aa.delete(1),yield zs(n)}))})}function Lf(n,e){return y(this,null,function*(){let t=H(n);t.asyncQueue.verifyOperationInProgress(),O(Bn,"RemoteStore received new credentials");let r=Zr(t);t.aa.add(3),yield Xr(t),r&&t.la.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.aa.delete(3),yield zs(t)})}function iw(n,e){return y(this,null,function*(){let t=H(n);e?(t.aa.delete(2),yield zs(t)):e||(t.aa.add(2),yield Xr(t),t.la.set("Unknown"))})}function zn(n){return n.Pa||(n.Pa=function(t,r,i){let o=H(t);return o.Y_(),new nu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{jo:ew.bind(null,n),Jo:tw.bind(null,n),Zo:nw.bind(null,n),Q_:rw.bind(null,n)}),n.ua.push(e=>y(null,null,function*(){e?(n.Pa.D_(),Mu(n)?Lu(n):n.la.set("Unknown")):(yield n.Pa.stop(),Kp(n))}))),n.Pa}var au=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Lt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new V(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Qp(n,e){if(gt("AsyncQueue",`${e}: ${n}`),jn(n))return new V(N.UNAVAILABLE,`${e}: ${n}`);throw n}var Ps=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||L.comparator(t.key,r.key):(t,r)=>L.comparator(t.key,r.key),this.keyedMap=kr(),this.sortedSet=new ie(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Cs=class{constructor(){this.Ia=new ie(L.comparator)}track(e){let t=e.doc.key,r=this.Ia.get(t);r?e.type!==0&&r.type===3?this.Ia=this.Ia.insert(t,e):e.type===3&&r.type!==1?this.Ia=this.Ia.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Ia=this.Ia.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Ia=this.Ia.remove(t):e.type===1&&r.type===2?this.Ia=this.Ia.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):F(63341,{Vt:e,Ea:r}):this.Ia=this.Ia.insert(t,e)}da(){let e=[];return this.Ia.inorderTraversal((t,r)=>{e.push(r)}),e}},qn=class n{constructor(e,t,r,i,o,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,Ps.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$s(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var cu=class{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some(e=>e.ma())}},uu=class{constructor(){this.queries=Mf(),this.onlineState="Unknown",this.fa=new Set}terminate(){(function(t,r){let i=H(t),o=i.queries;i.queries=Mf(),o.forEach((a,u)=>{for(let h of u.Ra)h.onError(r)})})(this,new V(N.ABORTED,"Firestore shutting down"))}};function Mf(){return new vt(n=>Sp(n),$s)}function sw(n,e){return y(this,null,function*(){let t=H(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Va()&&e.ma()&&(r=2):(o=new cu,r=e.ma()?0:1);try{switch(r){case 0:o.Aa=yield t.onListen(i,!0);break;case 1:o.Aa=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=Qp(a,`Initialization of query '${wn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.Ra.push(e),e.ga(t.onlineState),o.Aa&&e.pa(o.Aa)&&Fu(t)})}function ow(n,e){return y(this,null,function*(){let t=H(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.Ra.indexOf(e);a>=0&&(o.Ra.splice(a,1),o.Ra.length===0?i=e.ma()?0:1:!o.Va()&&e.ma()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function aw(n,e){let t=H(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.Ra)u.pa(i)&&(r=!0);a.Aa=i}}r&&Fu(t)}function cw(n,e,t){let r=H(n),i=r.queries.get(e);if(i)for(let o of i.Ra)o.onError(t);r.queries.delete(e)}function Fu(n){n.fa.forEach(e=>{e.next()})}var lu,Ff;(Ff=lu||(lu={})).ya="default",Ff.Cache="cache";var hu=class{constructor(e,t,r){this.query=e,this.wa=t,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=r||{}}pa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new qn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ba?this.Da(e)&&(this.wa.next(e),t=!0):this.va(e,this.onlineState)&&(this.Ca(e),t=!0),this.Sa=e,t}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let t=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),t=!0),t}va(e,t){if(!e.fromCache||!this.ma())return!0;let r=t!=="Offline";return(!this.options.Fa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Da(e){if(e.docChanges.length>0)return!0;let t=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ca(e){e=qn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==lu.Cache}};var ks=class{constructor(e){this.key=e}},Ds=class{constructor(e){this.key=e}},du=class{constructor(e,t){this.query=e,this.qa=t,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=Q(),this.mutatedKeys=Q(),this.Ua=Rp(e),this.Ka=new Ps(this.Ua)}get Wa(){return this.qa}Ga(e,t){let r=t?t.za:new Cs,i=t?t.Ka:this.Ka,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,v)=>{let w=i.get(p),R=js(this.query,v)?v:null,D=!!w&&this.mutatedKeys.has(w.key),x=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations),C=!1;w&&R?w.data.isEqual(R.data)?D!==x&&(r.track({type:3,doc:R}),C=!0):this.ja(w,R)||(r.track({type:2,doc:R}),C=!0,(h&&this.Ua(R,h)>0||d&&this.Ua(R,d)<0)&&(u=!0)):!w&&R?(r.track({type:0,doc:R}),C=!0):w&&!R&&(r.track({type:1,doc:w}),C=!0,(h||d)&&(u=!0)),C&&(R?(a=a.add(R),o=x?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ka:a,za:r,ys:u,mutatedKeys:o}}ja(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;let a=e.za.da();a.sort((p,v)=>function(R,D){let x=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return F(20277,{Vt:C})}};return x(R)-x(D)}(p.type,v.type)||this.Ua(p.doc,v.doc)),this.Ha(r),i=i!=null&&i;let u=t&&!i?this.Ja():[],h=this.$a.size===0&&this.current&&!i?1:0,d=h!==this.Qa;return this.Qa=h,a.length!==0||d?{snapshot:new qn(this.query,e.Ka,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ya:u}:{Ya:u}}ga(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new Cs,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach(t=>this.qa=this.qa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qa=this.qa.delete(t)),this.current=e.current)}Ja(){if(!this.current)return[];let e=this.$a;this.$a=Q(),this.Ka.forEach(r=>{this.Za(r.key)&&(this.$a=this.$a.add(r.key))});let t=[];return e.forEach(r=>{this.$a.has(r)||t.push(new Ds(r))}),this.$a.forEach(r=>{e.has(r)||t.push(new ks(r))}),t}Xa(e){this.qa=e.Ns,this.$a=Q();let t=this.Ga(e.documents);return this.applyChanges(t,!0)}eu(){return qn.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,this.Qa===0,this.hasCachedResults)}},Uu="SyncEngine",fu=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},pu=class{constructor(e){this.key=e,this.tu=!1}},mu=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.nu={},this.ru=new vt(u=>Sp(u),$s),this.iu=new Map,this.su=new Set,this.ou=new ie(L.comparator),this._u=new Map,this.au=new Hr,this.uu={},this.cu=new Map,this.lu=Gr.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return this.hu===!0}};function uw(n,e,t=!0){return y(this,null,function*(){let r=em(n),i,o=r.ru.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.eu()):i=yield Yp(r,e,t,!0),i})}function lw(n,e){return y(this,null,function*(){let t=em(n);yield Yp(t,e,!0,!1)})}function Yp(n,e,t,r){return y(this,null,function*(){let i=yield JE(n.localStore,Xe(e)),o=i.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t),u;return r&&(u=yield hw(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Gp(n.remoteStore,i),u})}function hw(n,e,t,r,i){return y(this,null,function*(){n.Pu=(v,w,R)=>function(x,C,j,q){return y(this,null,function*(){let U=C.view.Ga(j);U.ys&&(U=yield Nf(x.localStore,C.query,!1).then(({documents:E})=>C.view.Ga(E,U)));let $=q&&q.targetChanges.get(C.targetId),se=q&&q.targetMismatches.get(C.targetId)!=null,K=C.view.applyChanges(U,x.isPrimaryClient,$,se);return Bf(x,C.targetId,K.Ya),K.snapshot})}(n,v,w,R);let o=yield Nf(n.localStore,e,!0),a=new du(e,o.Ns),u=a.Ga(o.documents),h=zr.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);Bf(n,t,d.Ya);let p=new fu(e,t,a);return n.ru.set(e,p),n.iu.has(t)?n.iu.get(t).push(e):n.iu.set(t,[e]),d.snapshot})}function dw(n,e,t){return y(this,null,function*(){let r=H(n),i=r.ru.get(e),o=r.iu.get(i.targetId);if(o.length>1)return r.iu.set(i.targetId,o.filter(a=>!$s(a,e))),void r.ru.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Kc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&xu(r.remoteStore,i.targetId),gu(r,i.targetId)}).catch(Us))):(gu(r,i.targetId),yield Kc(r.localStore,i.targetId,!0))})}function fw(n,e){return y(this,null,function*(){let t=H(n),r=t.ru.get(e),i=t.iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),xu(t.remoteStore,r.targetId))})}function Jp(n,e){return y(this,null,function*(){let t=H(n);try{let r=yield QE(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t._u.get(o);a&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.tu=!0:i.modifiedDocuments.size>0?te(a.tu,14607):i.removedDocuments.size>0&&(te(a.tu,42227),a.tu=!1))}),yield Zp(t,r,e)}catch(r){yield Us(r)}})}function Uf(n,e,t){let r=H(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ru.forEach((o,a)=>{let u=a.view.ga(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=H(a);h.onlineState=u;let d=!1;h.queries.forEach((p,v)=>{for(let w of v.Ra)w.ga(u)&&(d=!0)}),d&&Fu(h)}(r.eventManager,e),i.length&&r.nu.Q_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function pw(n,e,t){return y(this,null,function*(){let r=H(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r._u.get(e),o=i&&i.key;if(o){let a=new ie(L.comparator);a=a.insert(o,qe.newNoDocument(o,B.min()));let u=Q().add(o),h=new ys(B.min(),new Map,new ie(z),a,u);yield Jp(r,h),r.ou=r.ou.remove(o),r._u.delete(e),Bu(r)}else yield Kc(r.localStore,e,!1).then(()=>gu(r,e,t)).catch(Us)})}function gu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.iu.get(e))n.ru.delete(r),t&&n.nu.Tu(r,t);n.iu.delete(e),n.isPrimaryClient&&n.au.Ur(e).forEach(r=>{n.au.containsKey(r)||Xp(n,r)})}function Xp(n,e){n.su.delete(e.path.canonicalString());let t=n.ou.get(e);t!==null&&(xu(n.remoteStore,t),n.ou=n.ou.remove(e),n._u.delete(t),Bu(n))}function Bf(n,e,t){for(let r of t)r instanceof ks?(n.au.addReference(r.key,e),mw(n,r)):r instanceof Ds?(O(Uu,"Document no longer in limbo: "+r.key),n.au.removeReference(r.key,e),n.au.containsKey(r.key)||Xp(n,r.key)):F(19791,{Iu:r})}function mw(n,e){let t=e.key,r=t.path.canonicalString();n.ou.get(t)||n.su.has(r)||(O(Uu,"New document in limbo: "+t),n.su.add(r),Bu(n))}function Bu(n){for(;n.su.size>0&&n.ou.size<n.maxConcurrentLimboResolutions;){let e=n.su.values().next().value;n.su.delete(e);let t=new L(ce.fromString(e)),r=n.lu.next();n._u.set(r,new pu(t)),n.ou=n.ou.insert(t,r),Gp(n.remoteStore,new Wr(Xe(Nu(t.path)),r,"TargetPurposeLimboResolution",Ru.le))}}function Zp(n,e,t){return y(this,null,function*(){let r=H(n),i=[],o=[],a=[];r.ru.isEmpty()||(r.ru.forEach((u,h)=>{a.push(r.Pu(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let v=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,v?"current":"not-current")}if(d){i.push(d);let v=zc.Ps(h.targetId,d);o.push(v)}}))}),yield Promise.all(a),r.nu.Q_(i),yield function(h,d){return y(this,null,function*(){let p=H(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>P.forEach(d,w=>P.forEach(w.ls,R=>p.persistence.referenceDelegate.addReference(v,w.targetId,R)).next(()=>P.forEach(w.hs,R=>p.persistence.referenceDelegate.removeReference(v,w.targetId,R)))))}catch(v){if(!jn(v))throw v;O(Ou,"Failed to update sequence numbers: "+v)}for(let v of d){let w=v.targetId;if(!v.fromCache){let R=p.Ss.get(w),D=R.snapshotVersion,x=R.withLastLimboFreeSnapshotVersion(D);p.Ss=p.Ss.insert(w,x)}}})}(r.localStore,o))})}function gw(n,e){return y(this,null,function*(){let t=H(n);if(!t.currentUser.isEqual(e)){O(Uu,"User change. New user:",e.toKey());let r=yield jp(t.localStore,e);t.currentUser=e,function(o,a){o.cu.forEach(u=>{u.forEach(h=>{h.reject(new V(N.CANCELLED,a))})}),o.cu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Zp(t,r.Ms)}})}function _w(n,e){let t=H(n),r=t._u.get(e);if(r&&r.tu)return Q().add(r.key);{let i=Q(),o=t.iu.get(e);if(!o)return i;for(let a of o){let u=t.ru.get(a);i=i.unionWith(u.view.Wa)}return i}}function em(n){let e=H(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=_w.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pw.bind(null,e),e.nu.Q_=aw.bind(null,e.eventManager),e.nu.Tu=cw.bind(null,e.eventManager),e}var tm=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return y(this,null,function*(){this.serializer=Wp(t.databaseInfo.databaseId),this.sharedClientState=this.Au(t),this.persistence=this.Ru(t),yield this.persistence.start(),this.localStore=this.Vu(t),this.gcScheduler=this.mu(t,this.localStore),this.indexBackfillerScheduler=this.fu(t,this.localStore)})}mu(t,r){return null}fu(t,r){return null}Vu(t){return KE(this.persistence,new Gc,t.initialUser,this.serializer)}Ru(t){return new Ts(jc.Ei,this.serializer)}Au(t){return new Qc}terminate(){return y(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),_u=class extends tm{constructor(e){super(),this.cacheSizeBytes=e}mu(e,t){te(this.persistence.referenceDelegate instanceof As,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new kc(r,e.asyncQueue,t)}Ru(e){let t=this.cacheSizeBytes!==void 0?xe.withCacheSize(this.cacheSizeBytes):xe.DEFAULT;return new Ts(r=>As.Ei(r,t),this.serializer)}};var yw=(()=>{class n{initialize(t,r){return y(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Uf(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=gw.bind(null,this.syncEngine),yield iw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new uu}()}createDatastore(t){let r=Wp(t.databaseInfo.databaseId),i=function(a){return new eu(a)}(t.databaseInfo);return function(a,u,h,d){return new iu(a,u,h,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,a,u,h){return new ou(i,o,a,u,h)}(this.localStore,this.datastore,t.asyncQueue,r=>Uf(this.syncEngine,r,0),function(){return Ss.C()?new Ss:new Yc}())}createSyncEngine(t,r){return function(o,a,u,h,d,p,v){let w=new mu(o,a,u,h,d,p);return v&&(w.hu=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return y(this,null,function*(){var t,r;yield function(o){return y(this,null,function*(){let a=H(o);O(Bn,"RemoteStore shutting down."),a.aa.add(5),yield Xr(a),a.ca.shutdown(),a.la.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var yu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):gt("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Ut="FirestoreClient",vu=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=he.UNAUTHENTICATED,this.clientId=ls.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,a=>y(this,null,function*(){O(Ut,"Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(O(Ut,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Lt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Qp(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Ha(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O(Ut,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(null,null,function*(){r.isEqual(i)||(yield jp(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function qf(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield vw(n);O(Ut,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Lf(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Lf(e.remoteStore,i)),n._onlineComponents=e})}function vw(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O(Ut,"Using user provided OfflineComponentProvider");try{yield Ha(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===N.FAILED_PRECONDITION||i.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Cn("Error using user provided cache. Falling back to memory cache: "+t),yield Ha(n,new tm)}}else O(Ut,"Using default OfflineComponentProvider"),yield Ha(n,new _u(void 0));return n._offlineComponents})}function Iw(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O(Ut,"Using user provided OnlineComponentProvider"),yield qf(n,n._uninitializedComponentsProvider._online)):(O(Ut,"Using default OnlineComponentProvider"),yield qf(n,new yw))),n._onlineComponents})}function $f(n){return y(this,null,function*(){let e=yield Iw(n),t=e.eventManager;return t.onListen=uw.bind(null,e.syncEngine),t.onUnlisten=dw.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=lw.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=fw.bind(null,e.syncEngine),t})}function nm(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var jf=new Map;function Ew(n,e,t){if(!t)throw new V(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ww(n,e,t,r){if(e===!0&&r===!0)throw new V(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function zf(n){if(!L.isDocumentKey(n))throw new V(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Tw(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":F(12329,{type:typeof n})}function as(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Tw(n);throw new V(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var rm="firestore.googleapis.com",Wf=!0,Ns=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new V(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rm,this.ssl=Wf}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Wf;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$p;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WE)throw new V(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ww("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nm((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new V(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new V(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new V(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Kr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ns({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new V(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new V(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ns(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Ka;switch(r.type){case"firstParty":return new Xa(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,ot("Firestore",this._settings.isUsingEmulator),this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return y(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=jf.get(t);r&&(O("ComponentProvider","Removing Datastore"),jf.delete(t),r.terminate())}(this),Promise.resolve()}};function im(n,e,t,r={}){var i;n=as(n,Kr);let o=st(e),a=n._getSettings(),u=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),h=`${e}:${t}`;a.host!==rm&&a.host!==h&&Cn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},a),{host:h,ssl:o,emulatorOptions:r});if(!ze(d,u)&&(n._setSettings(d),o&&(_n(`https://${h}`),ot("Firestore",!0)),r.mockUserToken)){let p,v;if(typeof r.mockUserToken=="string")p=r.mockUserToken,v=he.MOCK_USER;else{p=Pi(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let w=r.mockUserToken.sub||r.mockUserToken.user_id;if(!w)throw new V(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new he(w)}n._authCredentials=new Qa(new cs(p,v))}}var Os=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},mt=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Qr=class n extends Os{constructor(e,t,r){super(e,t,Nu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new mt(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function sm(n,e,...t){if(n=Re(n),arguments.length===1&&(e=ls.newId()),Ew("doc","path",e),n instanceof Kr){let r=ce.fromString(e,...t);return zf(r),new mt(n,null,new L(r))}{if(!(n instanceof mt||n instanceof Qr))throw new V(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return zf(r),new mt(n.firestore,n instanceof Qr?n.converter:null,new L(r))}}var Gf="AsyncQueue",xs=class{constructor(e=Promise.resolve()){this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new Rs(this,"async_queue_retry"),this.ju=()=>{let r=Ga();r&&O(Gf,"Visibility state changed to "+r.visibilityState),this.y_.A_()},this.Hu=e;let t=Ga();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;let t=Ga();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise(()=>{});let t=new Lt;return this.Yu(()=>this.$u&&this.Gu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qu.push(e),this.Zu()))}Zu(){return y(this,null,function*(){if(this.Qu.length!==0){try{yield this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!jn(e))throw e;O(Gf,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_(()=>this.Zu())}})}Yu(e){let t=this.Hu.then(()=>(this.Wu=!0,e().catch(r=>{throw this.Ku=r,this.Wu=!1,gt("INTERNAL UNHANDLED ERROR: ",Hf(r)),r}).then(r=>(this.Wu=!1,r))));return this.Hu=t,t}enqueueAfterDelay(e,t,r){this.Ju(),this.zu.indexOf(e)>-1&&(t=0);let i=au.createAndSchedule(this,e,t,r,o=>this.Xu(o));return this.Uu.push(i),i}Ju(){this.Ku&&F(47125,{ec:Hf(this.Ku)})}verifyOperationInProgress(){}tc(){return y(this,null,function*(){let e;do e=this.Hu,yield e;while(e!==this.Hu)})}nc(e){for(let t of this.Uu)if(t.timerId===e)return!0;return!1}rc(e){return this.tc().then(()=>{this.Uu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Uu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.tc()})}sc(e){this.zu.push(e)}Xu(e){let t=this.Uu.indexOf(e);this.Uu.splice(t,1)}};function Hf(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Kf(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var Yr=class extends Kr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new xs,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return y(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new xs(e),this._firestoreClient=void 0,yield e}})}};function om(n,e){let t=typeof n=="object"?n:ct(),r=typeof n=="string"?n:e||ms,i=Pt(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Ri("firestore");o&&im(i,...o)}return i}function Aw(n){if(n._terminated)throw new V(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bw(n),n._firestoreClient}function bw(n){var e,t,r;let i=n._freezeSettings(),o=function(u,h,d,p){return new rc(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,nm(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new vu(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(u){let h=u?._online.build();return{_offline:u?._offline.build(h),_online:h}}(n._componentsProvider))}var Iu=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ee.fromBase64String(e))}catch(t){throw new V(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ee.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Vs=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new V(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Be(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Eu=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return z(this._lat,e._lat)||z(this._long,e._long)}};var wu=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var Sw=new RegExp("[~\\*/\\[\\]]");function Rw(n,e,t){if(e.search(Sw)>=0)throw Qf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Vs(...e.split("."))._internalPath}catch{throw Qf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Qf(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new V(N.INVALID_ARGUMENT,u+n+h)}var Ls=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new mt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Tu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(am("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Tu=class extends Ls{data(){return super.data()}};function am(n,e){return typeof e=="string"?Rw(n,e):e instanceof Vs?e._internalPath:e._delegate._internalPath}function Pw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new V(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Au=class{convertValue(e,t="none"){switch(Mt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ee(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw F(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Jr(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[Fr].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ee(a.doubleValue));return new wu(o)}convertGeoPoint(e){return new Eu(ee(e.latitude),ee(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=qs(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Mr(e));default:return null}}convertTimestamp(e){let t=_t(e);return new Ve(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ce.fromString(e);te(qp(r),9688,{name:e});let i=new gs(r.get(1),r.get(3)),o=new L(r.popFirst(5));return i.isEqual(t)||gt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var an=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ms=class extends Ls{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Pn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(am("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Pn=class extends Ms{data(e={}){return super.data(e)}},bu=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new an(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Pn(this._firestore,this._userDataWriter,r.key,r,new an(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new Pn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new an(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new Pn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new an(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:Cw(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Cw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return F(61501,{type:n})}}var Fs=class extends Au{constructor(e){super(),this.firestore=e}convertBytes(e){return new Iu(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new mt(this.firestore,null,t)}};function qu(n,...e){var t,r,i;n=Re(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Kf(e[a])||(o=e[a],a++);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Kf(e[a])){let v=e[a];e[a]=(t=v.next)===null||t===void 0?void 0:t.bind(v),e[a+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[a+2]=(i=v.complete)===null||i===void 0?void 0:i.bind(v)}let h,d,p;if(n instanceof mt)d=as(n.firestore,Yr),p=Nu(n._key.path),h={next:v=>{e[a]&&e[a](kw(d,n,v))},error:e[a+1],complete:e[a+2]};else{let v=as(n,Os);d=as(v.firestore,Yr),p=v._query;let w=new Fs(d);h={next:R=>{e[a]&&e[a](new bu(d,w,v,R))},error:e[a+1],complete:e[a+2]},Pw(n._query)}return function(w,R,D,x){let C=new yu(x),j=new hu(R,C,D);return w.asyncQueue.enqueueAndForget(()=>y(null,null,function*(){return sw(yield $f(w),j)})),()=>{C.yu(),w.asyncQueue.enqueueAndForget(()=>y(null,null,function*(){return ow(yield $f(w),j)}))}}(Aw(d),p,u,h)}function kw(n,e,t){let r=t.docs.get(e._key),i=new Fs(n);return new Ms(n,i,e._key,r,new an(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){$n=i})(He),De(new me("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new Yr(new Ya(r.getProvider("auth-internal")),new Za(a,r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new V(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gs(d.options.projectId,p)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),X(rf,sf,e),X(rf,sf,"esm2017")})();var Ws=function(){return Ws=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ws.apply(this,arguments)};var Ow={includeMetadataChanges:!1};function cm(n,e){return e===void 0&&(e=Ow),new ke(function(t){var r=qu(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function um(n){return cm(n,{includeMetadataChanges:!0})}function lm(n,e){return e===void 0&&(e={}),um(n).pipe(be(function(t){return hm(t,e)}))}function hm(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Ws(Ws({},r),(t={},t[e.idField]=n.id,t))}var ln=class{constructor(e){return e}},dm="firestore",$u=class{constructor(){return Ct(dm)}};var ju=new $e("angularfire2.firestore-instances");function xw(n,e){let t=Yt(dm,n,e);return t&&new ln(t)}function Vw(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ln(r)}}var Lw={provide:$u,deps:[[new pe,ju]]},Mw={provide:ln,useFactory:xw,deps:[[new pe,ju],Fe]};function fm(n,...e){return X("angularfire",Ke.full,"fst"),je([Mw,Lw,{provide:ju,useFactory:Vw(n),multi:!0,deps:[Se,Ne,Qe,ut,[new pe,nn],[new pe,Dt],...e]}])}var pm=Oe(lm,!0);var mm=Oe(sm,!0,2);var gm=Oe(om,!0);var Wn=class n{auth=re(tn);firestore=re(ln);firebaseUser$=Zd(this.auth);user$=this.firebaseUser$.pipe(zt(e=>{if(!e)return wo(null);let t=mm(this.firestore,`users/${e.uid}`);return pm(t,{idField:"uid"})}),ih(1));isAdmin$=this.user$.pipe(be(e=>e?.role==="admin"));isEmployee$=this.user$.pipe(be(e=>e?.role==="employee"));static \u0275fac=function(t){return new(t||n)};static \u0275prov=Gt({token:n,factory:n.\u0275fac,providedIn:"root"})};var zu=()=>re(Wn).isAdmin$.pipe(be(e=>!!e));var Wu=()=>re(Wn).isEmployee$.pipe(be(e=>!!e));var _m=[{path:"",redirectTo:"auth/login",pathMatch:"full"},{path:"auth/login",loadComponent:()=>import("./chunk-5ZG7SN2I.js").then(n=>n.HomeComponent)},{path:"admin/dashboard",canActivate:[zu],loadComponent:()=>import("./chunk-UGDA7MAW.js").then(n=>n.DashboardComponent)},{path:"admin/calendar/:userId",canActivate:[zu],loadComponent:()=>import("./chunk-L3QQC75S.js").then(n=>n.CalendarManagementComponent)},{path:"employee/calendar",canActivate:[Wu],loadComponent:()=>import("./chunk-UOGXNJHB.js").then(n=>n.CalendarComponent)},{path:"employee/photo",canActivate:[Wu],loadComponent:()=>import("./chunk-YS5OBGJJ.js").then(n=>n.PhotoComponent)},{path:"**",redirectTo:"auth/login"}];var Gu="Service workers are disabled or not supported by this browser",Gn=class{serviceWorker;worker;registration;events;constructor(e,t){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=new ke(r=>r.error(new Wt(5601,!1)));else{let r=null,i=new vi;this.worker=new ke(d=>(r!==null&&d.next(r),i.subscribe(p=>d.next(p))));let o=()=>{let{controller:d}=e;d!==null&&(r=d,i.next(r))};e.addEventListener("controllerchange",o),o(),this.registration=this.worker.pipe(zt(()=>e.getRegistration()));let a=new vi;this.events=a.asObservable();let u=d=>{let{data:p}=d;p?.type&&a.next(p)};e.addEventListener("message",u),t?.get(Ao,null,{optional:!0})?.onDestroy(()=>{e.removeEventListener("controllerchange",o),e.removeEventListener("message",u)})}}postMessage(e,t){return new Promise(r=>{this.worker.pipe(gn(1)).subscribe(i=>{i.postMessage(fr({action:e},t)),r()})})}postMessageWithOperation(e,t,r){let i=this.waitForOperationCompleted(r),o=this.postMessage(e,t);return Promise.all([o,i]).then(([,a])=>a)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let t;return typeof e=="string"?t=r=>r.type===e:t=r=>e.includes(r.type),this.events.pipe(Ii(t))}nextEventOfType(e){return this.eventsOfType(e).pipe(gn(1))}waitForOperationCompleted(e){return new Promise((t,r)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(Ii(i=>i.nonce===e),gn(1),be(i=>{if(i.result!==void 0)return i.result;throw new Error(i.error)})).subscribe({next:t,error:r})})}get isEnabled(){return!!this.serviceWorker}},Fw=(()=>{class n{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new vi;constructor(t){if(this.sw=t,!t.isEnabled){this.messages=mn,this.notificationClicks=mn,this.subscription=mn;return}this.messages=this.sw.eventsOfType("PUSH").pipe(be(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(be(i=>i.data)),this.pushManager=this.sw.registration.pipe(be(i=>i.pushManager));let r=this.pushManager.pipe(zt(i=>i.getSubscription()));this.subscription=new ke(i=>{let o=r.subscribe(i),a=this.subscriptionChanges.subscribe(i);return()=>{o.unsubscribe(),a.unsubscribe()}})}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(Gu));let r={userVisibleOnly:!0},i=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(i.length));for(let a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return r.applicationServerKey=o,new Promise((a,u)=>{this.pushManager.pipe(zt(h=>h.subscribe(r)),gn(1)).subscribe({next:h=>{this.subscriptionChanges.next(h),a(h)},error:u})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(Gu));let t=r=>{if(r===null)throw new Wt(5602,!1);return r.unsubscribe().then(i=>{if(!i)throw new Wt(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((r,i)=>{this.subscription.pipe(gn(1),zt(t)).subscribe({next:r,error:i})})}decodeBase64(t){return atob(t)}static \u0275fac=function(r){return new(r||n)(To(Gn))};static \u0275prov=Gt({token:n,factory:n.\u0275fac})}return n})(),Uw=(()=>{class n{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=mn,this.unrecoverable=mn;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Gu));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Wt(5601,!1));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static \u0275fac=function(r){return new(r||n)(To(Gn))};static \u0275prov=Gt({token:n,factory:n.\u0275fac})}return n})();var vm=new $e("");function Bw(){let n=re(ei);if(!("serviceWorker"in navigator&&n.enabled!==!1))return;let e=re(vm),t=re(Se),r=re(Ao);t.runOutsideAngular(()=>{let i=navigator.serviceWorker,o=()=>i.controller?.postMessage({action:"INITIALIZE"});i.addEventListener("controllerchange",o),r.onDestroy(()=>{i.removeEventListener("controllerchange",o)})}),t.runOutsideAngular(()=>{let i,{registrationStrategy:o}=n;if(typeof o=="function")i=new Promise(a=>o().subscribe(()=>a()));else{let[a,...u]=(o||"registerWhenStable:30000").split(":");switch(a){case"registerImmediately":i=Promise.resolve();break;case"registerWithDelay":i=ym(+u[0]||0);break;case"registerWhenStable":i=Promise.race([r.whenStable(),ym(+u[0])]);break;default:throw new Wt(5600,!1)}}i.then(()=>navigator.serviceWorker.register(e,{scope:n.scope}).catch(a=>console.error(sh(5604,!1))))})}function ym(n){return new Promise(e=>setTimeout(e,n))}function qw(n,e){return new Gn(n.enabled!==!1?navigator.serviceWorker:void 0,e)}var ei=class{enabled;scope;registrationStrategy};function Im(n,e={}){return je([Fw,Uw,{provide:vm,useValue:n},{provide:ei,useValue:e},{provide:Gn,useFactory:qw,deps:[ei,Ne]},lh(Bw)])}var Sm="firebasestorage.googleapis.com",$w="storageBucket",jw=2*60*1e3,zw=10*60*1e3;var tt=class n extends Ae{constructor(e,t,r=0){super(Hu(e),`Firebase Storage: ${t} (${Hu(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Hu(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Et=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Et||{});function Hu(n){return"storage/"+n}function Ww(){let n="An unknown error occurred, please check the error payload for server response.";return new tt(Et.UNKNOWN,n)}function Gw(){return new tt(Et.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Hw(){return new tt(Et.CANCELED,"User canceled the upload/download.")}function Kw(n){return new tt(Et.INVALID_URL,"Invalid URL '"+n+"'.")}function Qw(n){return new tt(Et.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Em(n){return new tt(Et.INVALID_ARGUMENT,n)}function Rm(){return new tt(Et.APP_DELETED,"The Firebase app was deleted.")}function Yw(n){return new tt(Et.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var It=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw Qw(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function o($){$.path.charAt($.path.length-1)==="/"&&($.path_=$.path_.slice(0,-1))}let a="(/(.*))?$",u=new RegExp("^gs://"+i+a,"i"),h={bucket:1,path:3};function d($){$.path_=decodeURIComponent($.path)}let p="v[A-Za-z0-9_]+",v=t.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",R=new RegExp(`^https?://${v}/${p}/b/${i}/o${w}`,"i"),D={bucket:1,path:3},x=t===Sm?"(?:storage.googleapis.com|storage.cloud.google.com)":t,C="([^?#]*)",j=new RegExp(`^https?://${x}/${i}/${C}`,"i"),U=[{regex:u,indices:h,postModify:o},{regex:R,indices:D,postModify:d},{regex:j,indices:{bucket:1,path:2},postModify:d}];for(let $=0;$<U.length;$++){let se=U[$],K=se.regex.exec(e);if(K){let E=K[se.indices.bucket],m=K[se.indices.path];m||(m=""),r=new n(E,m),se.postModify(r);break}}if(r==null)throw Kw(e);return r}},Ku=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function Jw(n,e,t){let r=1,i=null,o=null,a=!1,u=0;function h(){return u===2}let d=!1;function p(...C){d||(d=!0,e.apply(null,C))}function v(C){i=setTimeout(()=>{i=null,n(R,h())},C)}function w(){o&&clearTimeout(o)}function R(C,...j){if(d){w();return}if(C){w(),p.call(null,C,...j);return}if(h()||a){w(),p.call(null,C,...j);return}r<64&&(r*=2);let U;u===1?(u=2,U=0):U=(r+Math.random())*1e3,v(U)}let D=!1;function x(C){D||(D=!0,w(),!d&&(i!==null?(C||(u=2),clearTimeout(i),v(0)):C||(u=1)))}return v(0),o=setTimeout(()=>{a=!0,x(!0)},t),x}function Xw(n){n(!1)}function Zw(n){return n!==void 0}function wm(n,e,t,r){if(r<e)throw Em(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Em(`Invalid value for '${n}'. Expected ${t} or less.`)}function eT(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Qu=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Qu||{});function tT(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}var Yu=class{constructor(e,t,r,i,o,a,u,h,d,p,v,w=!0,R=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=u,this.errorCallback_=h,this.timeout_=d,this.progressCallback_=p,this.connectionFactory_=v,this.retry=w,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((D,x)=>{this.resolve_=D,this.reject_=x,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Hn(!1,null,!0));return}let o=this.connectionFactory_();this.pendingConnection_=o;let a=u=>{let h=u.loaded,d=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,d)};this.progressCallback_!==null&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(a),this.pendingConnection_=null;let u=o.getErrorCode()===Qu.NO_ERROR,h=o.getStatus();if(!u||tT(h,this.additionalRetryCodes_)&&this.retry){let p=o.getErrorCode()===Qu.ABORT;r(!1,new Hn(!1,null,p));return}let d=this.successCodes_.indexOf(h)!==-1;r(!0,new Hn(d,o))})},t=(r,i)=>{let o=this.resolve_,a=this.reject_,u=i.connection;if(i.wasSuccessCode)try{let h=this.callback_(u,u.getResponse());Zw(h)?o(h):o()}catch(h){a(h)}else if(u!==null){let h=Ww();h.serverResponse=u.getErrorText(),this.errorCallback_?a(this.errorCallback_(u,h)):a(h)}else if(i.canceled){let h=this.appDelete_?Rm():Hw();a(h)}else{let h=Gw();a(h)}};this.canceled_?t(!1,new Hn(!1,null,!0)):this.backoffId_=Jw(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Xw(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Hn=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function nT(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function rT(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function iT(n,e){e&&(n["X-Firebase-GMPID"]=e)}function sT(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function oT(n,e,t,r,i,o,a=!0,u=!1){let h=eT(n.urlParams),d=n.url+h,p=Object.assign({},n.headers);return iT(p,e),nT(p,t),rT(p,o),sT(p,r),new Yu(d,n.method,p,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,u)}function aT(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function cT(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}var IR=256*1024;var Ju=class n{constructor(e,t){this._service=e,t instanceof It?this._location=t:this._location=It.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new It(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return cT(this._location.path)}get storage(){return this._service}get parent(){let e=aT(this._location.path);if(e===null)return null;let t=new It(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Yw(e)}};function Tm(n,e){let t=e?.[$w];return t==null?null:It.makeFromBucketSpec(t,n)}function uT(n,e,t,r={}){n.host=`${e}:${t}`;let i=st(e);i&&(_n(`https://${n.host}`),ot("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";let{mockUserToken:o}=r;o&&(n._overrideAuthToken=typeof o=="string"?o:Pi(o,n.app.options.projectId))}var Xu=class{constructor(e,t,r,i,o,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._isUsingEmulator=a,this._bucket=null,this._host=Sm,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=jw,this._maxUploadRetryTime=zw,this._requests=new Set,i!=null?this._bucket=It.makeFromBucketSpec(i,this._host):this._bucket=Tm(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=It.makeFromBucketSpec(this._url,e):this._bucket=Tm(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){wm("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){wm("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return y(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return y(this,null,function*(){if(Pe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ju(this,e)}_makeRequest(e,t,r,i,o=!0){if(this._deleted)return new Ku(Rm());{let a=oT(e,this._appId,r,i,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,t){return y(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},Am="@firebase/storage",bm="0.13.10";var Pm="storage";function Cm(n=ct(),e){n=Re(n),ot("Storage",!1);let r=Pt(n,Pm).getImmediate({identifier:e}),i=Ri("storage");return i&&km(r,...i),r}function km(n,e,t,r={}){uT(n,e,t,r)}function lT(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Xu(t,r,i,e,He)}function hT(){De(new me(Pm,lT,"PUBLIC").setMultipleInstances(!0)),X(Am,bm,""),X(Am,bm,"esm2017")}hT();var ti=class{constructor(e){return e}},Dm="storage",Zu=class{constructor(){return Ct(Dm)}};var el=new $e("angularfire2.storage-instances");function dT(n,e){let t=Yt(Dm,n,e);return t&&new ti(t)}function fT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ti(r)}}var pT={provide:Zu,deps:[[new pe,el]]},mT={provide:ti,useFactory:dT,deps:[[new pe,el],Fe]};function Nm(n,...e){return X("angularfire",Ke.full,"gcs"),je([mT,pT,{provide:el,useFactory:fT(n),multi:!0,deps:[Se,Ne,Qe,ut,[new pe,nn],[new pe,Dt],...e]}])}var Om=Oe(Cm,!0);var xm={production:!1,firebase:{apiKey:"AIzaSyApT8x5zhBG0P-x4B2naUhLK3sKFvyOMdQ",authDomain:"ecoapp-351bb.firebaseapp.com",projectId:"ecoapp-351bb",storageBucket:"ecoapp-351bb.firebasestorage.app",messagingSenderId:"757771911126",appId:"1:757771911126:web:98f089d7b98677b3c72e77"}};var Vm={providers:[mh({eventCoalescing:!0}),_h(_m),Ih({}),Im("ngsw-worker.js",{enabled:!pr(),registrationStrategy:"registerWhenStable:30000"}),Yh(()=>Jh(xm.firebase)),Xd(()=>ef()),fm(()=>gm()),Nm(()=>Om())]};gh(Ti,Vm).catch(n=>console.error(n));
